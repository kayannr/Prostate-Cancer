<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Kay Royo" />
    
    
    <title>Prostate Cancer</title>

        <script src="STA206-Kay-Royo-Final-Project_files/header-attrs-2.11/header-attrs.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="STA206-Kay-Royo-Final-Project_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/navigation-1.1/tabsets.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="STA206-Kay-Royo-Final-Project_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/readthedown-0.1/readthedown.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/htmlwidgets-1.5.4/htmlwidgets.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/datatables-binding-0.19/datatables.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
        <link href="STA206-Kay-Royo-Final-Project_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/nouislider-7.0.10/jquery.nouislider.min.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/selectize-0.12.0/selectize.min.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/crosstalk-1.1.1/js/crosstalk.min.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/plotly-binding-4.9.4.1/plotly.js"></script>
        <script src="STA206-Kay-Royo-Final-Project_files/typedarray-0.1/typedarray.min.js"></script>
        <link href="STA206-Kay-Royo-Final-Project_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
        <script src="STA206-Kay-Royo-Final-Project_files/plotly-main-1.57.1/plotly-latest.min.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="mstyle.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
        
      <h1 class="title">Prostate Cancer</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Prostate Cancer</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#abstract">Abstract</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#methods-and-results">Methods and Results</a></li>
      <li><a href="#part-iii-model-building-and-model-selection">Part III: Model building and model selection</a></li>
      <li><a href="#conclusion-and-discussion">Conclusion and Discussion</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Kay Royo</p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 12/5/2021</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p><link rel="stylesheet" href="mystyle.css"></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>The objective of this project is to identify the association between prostate-specific antigen (PSA) and a variety of prognostic clinical measurements in men with advanced prostate cancer. Cancer volume, weight, age, benign prostatic hyperplasia, seminal vesicle invasion, capsular penetration, and gleason score are the set of clinical measurements included in this analysis. A variety of multiple linear regression models were investigated to identify the relationship between PSA and these clinical measurements. Using some of the predictor variables mentioned, a final linear regression model was developed in order to predict the level of PSA among men diagnosed with prostate cancer. The result of the analysis reveals that cancer volume, benign prostatic hyperplasia, and seminal vesicle invasion are useful factors in detecting the PSA level in men with prostate cancer. This analysis uses a dataset collected from men with prostate cancer and does not include any measurements on men who are not diagnosed with prostate cancer.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Prostate cancer is one of the most common causes of cancer-related deaths among men. In the US, the American Cancer Society estimates approximately 248,530 new cases and 34,130 deaths from prostate cancer for 2021 (American Cancer Society, 2021). Additionally, there is a high risk of prostate cancer in men. The American Cancer Society estimates that approximately 1 in 8 men will be diagnosed with prostate cancer and 1 in 41 men will die of prostate cancer.</p>
<p><br></p>
<p>Prostate-specific antigen (PSA), an enzyme produced by the prostate, is commonly recommended as a screening mechanism for detecting prostate cancer. In order to become an efficient screening tool, it is important that we understand how PSA levels relate to factors that may determine prognosis and outcome. However, PSA screening does not always guarantee accurate results. In rare cases, some men with prostate cancer do not have an elevated PSA and some men with high level of PSA do not have prostate cancer. Moreover, PSA levels can change for variety of reasons other than cancer. Some of the other common causes of high PSA levels include benign prostatic hyperplasia (BPH), urinary tract infection (UTI), and prostatitis (prostate inflammation) (Whelan, 2017). Despite this, PSA level detection is still currently one of the most helpful method used in prostate cancer diagnosis.</p>
<p><br></p>
<p>The data used to analyze the relationship between PSA level and a number of prognostic clinical measurements were collected on 97 men between ages 41 and 79 who were about to undergo radical prostectomies (Stamey et al., 1989). The statistical analysis performed to analyze this dataset involves conducting a series of multiple regression analyses used to determine the best model predictor for PSA level in men who are diagnosed with prostate cancer using both quantitative and qualitative clinical measurements included in the data. The other clinical measurements included in the data aside from PSA level are commonly measured in men with prostate cancer.</p>
</div>
<div id="methods-and-results" class="section level2">
<h2>Methods and Results</h2>
<p>The goal of this analysis was to build a multiple regression model to predict the level of PSA from a subset of predictors: cancer volume, prostate weight, patient age, benign prostatic hyperplasia, seminal vesicle invasion, capsular penetration, and gleason score. In order to reach this goal, the project methodology was split into multiple parts. The relevant steps taken to perform the analysis includes exploratory data analysis, model building, model selection, model validation, and model diagnostics.</p>
<p><br><br></p>
<div id="part-i-exploratory-data-analysis" class="section level3">
<h3>Part I: Exploratory Data Analysis</h3>
<p>The purpose of the exploratory data analysis was to investigate the data to be used in the multiple regression analyses. The dataset did not include any missing values. Two variables (seminal vesicle invasion and gleason score) were converted to categorical (qualitative) variables. Out of the 97 advanced prostate cancer cases in the dataset, about 78% had no seminal vesicle invasion, which suggests that the presence of seminal vesicle invasion does not imply prostate cancer is present but it is positively correlated with PSA level (Figure 1). The relationships between the quantitative variables did not show any obvious nonlinearity (Figure 3). The results reveal a high correlation between PSA level and predictor variables such as cancer volume, and capsular penetration. Since the PSA level have a severely right-skewed distribution as shown in Figure 3, it can be transformed using a log transformation, which had similar effect to PSA’s distribution as the power transformation of -0.1 suggested by the Box-cox log-likelihood procedure (Figure 5). Performing the log transformation increased the coefficient of determination (<span class="math inline">\(R^2\)</span>) of the first-order model with all seven predictors. Additionally, exploring the dataset showed that PSA level increases from low to high gleason score (high prognosis) and is weakly correlated with prostate weight and patient age.</p>
<div id="data-processing-and-manipulation" class="section level4">
<h4>Data Processing and Manipulation</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Read data into R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/kayan/R-Projects/STA206/Project/data/prostate.txt&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Assign header names </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;patient_id&quot;</span>,<span class="st">&quot;psa_level&quot;</span>,<span class="st">&quot;cancer_vol&quot;</span>,<span class="st">&quot;weight&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;benign_prostatic_hyperplasia&quot;</span>, <span class="st">&quot;seminal_vesicle_invasion&quot;</span>, <span class="st">&quot;capsular_penetration&quot;</span>, <span class="st">&quot;gleason_score&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##Convert data to dataframe</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">as.data.frame</span>(data)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">##View data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(data, <span class="at">caption =</span> <span class="st">&#39;Table 1: Prostate Cancer Data&#39;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>,<span class="at">filter=</span><span class="st">&quot;top&quot;</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX=</span>F, <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">width =</span> <span class="st">&#39;50px&#39;</span>, <span class="at">targets =</span> <span class="st">&quot;_all&quot;</span>))))</span></code></pre></div>
<div id="htmlwidget-335d9e6f1f9e07f89664" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-335d9e6f1f9e07f89664">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"97\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.651\" data-max=\"265.072\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.2592\" data-max=\"45.6042\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"10.697\" data-max=\"450.339\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"41\" data-max=\"79\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"10.2779\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"18.1741\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"6\" data-max=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 1: Prostate Cancer Data<\/caption>","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97],[0.651,0.852,0.852,0.852,1.448,2.16,2.16,2.34,2.858,2.858,3.561,3.561,3.561,3.857,4.055,4.263,4.349,4.437,4.759,4.953,5.155,5.259,5.474,5.529,5.641,5.871,6.05,6.172,6.36,6.619,6.821,7.463,7.463,7.538,7.768,8.085,8.671,8.935,9.116,9.777,9.974,10.074,10.278,10.697,12.429,12.807,13.066,13.066,13.33,13.33,14.296,14.585,14.585,14.732,14.88,15.18,16.281,16.281,16.61,16.61,17.116,17.288,17.288,17.814,17.814,17.993,18.541,19.298,19.298,19.492,20.287,20.905,21.328,21.758,26.576,28.219,29.666,31.187,31.817,33.448,33.784,34.124,35.517,35.517,36.234,37.713,39.646,40.854,53.517,54.055,56.261,62.178,80.64,107.77,170.716,239.847,265.072],[0.5599,0.3716,0.6005,0.3012,2.117,0.3499,2.0959,1.9937,0.4584,1.2461,1.284,0.2592,5.0028,4.3929,3.3535,4.6646,0.657,9.8749,0.5712,1.1972,3.1582,7.846,0.5827,5.9299,1.477,4.2631,1.6653,0.6703,2.8292,11.134,1.3364,1.1972,3.5966,1.0101,0.99,3.7062,4.1371,1.5841,14.2963,2.2255,1.8589,4.2207,1.786,5.8709,4.4371,5.2593,15.3329,3.1899,5.7546,3.3872,2.9743,5.2593,1.6653,8.4149,23.3361,3.5609,2.6379,1.5841,1.716,2.8864,1.5841,7.3891,16.119,7.6141,7.9248,4.306,7.5383,9.025,0.6376,3.2871,6.4237,3.1899,3.3535,6.2965,20.0855,23.1039,7.4633,12.6797,14.154,16.119,4.3492,12.3049,13.5991,14.5851,4.7588,27.1126,7.5383,5.6407,16.6099,4.7588,25.7903,12.5535,16.9455,45.6042,18.3568,17.8143,32.1367],[15.959,27.66,14.732,26.576,30.877,25.28,32.137,34.467,34.467,25.534,36.598,36.598,20.491,20.086,31.187,21.328,33.784,38.475,26.311,46.063,30.569,33.115,29.371,31.5,39.252,22.646,41.264,47.942,22.874,29.371,59.74,450.339,20.905,26.311,25.028,61.559,38.861,10.697,59.74,20.287,23.104,39.646,47.942,49.402,30.265,29.666,54.598,56.826,33.115,35.517,54.055,68.717,37.713,61.559,33.784,72.24,17.637,42.948,65.366,46.993,91.836,41.264,33.784,50.4,37.338,46.525,48.424,57.397,82.269,119.104,36.234,28.219,46.063,25.534,46.993,26.05,83.931,77.478,35.874,45.604,21.542,32.137,48.911,46.525,40.854,33.784,41.679,29.079,112.168,40.447,60.34,39.646,48.424,49.402,29.964,43.38,52.985],[50,58,74,58,62,50,64,58,47,63,65,63,63,67,57,66,70,66,41,70,59,60,59,63,69,68,65,67,67,65,65,65,71,54,63,64,73,64,68,56,60,68,62,61,66,61,79,68,43,70,68,64,64,68,59,66,47,49,70,61,73,63,72,66,64,61,68,72,69,72,60,77,69,60,69,68,72,78,69,63,66,57,77,65,60,64,58,62,65,76,68,61,68,44,52,68,68],[0,0,0,0,0,0,1.8589,4.6646,0,0,0,3.5609,0,0,0,0,3.4556,0,0,5.2593,0,4.3492,0.4493,1.5527,4.953,1.3499,0,6.1719,1.2461,0,7.0993,5.4739,3.5609,0,0,8.7583,0.5599,0,3.9354,2.56,0,0,5.529,0,5.7546,1.8589,6.5535,5.529,0,3.9354,0,7.9248,4.4371,5.8709,0,8.3311,0,4.1371,1.5527,3.6328,10.2779,5.0531,0,7.4633,0,3.7434,5.9299,10.0744,0,10.2779,0,5.7546,0,1.5527,0,0.9512,8.3311,10.2779,0,0,1.7507,1.5527,0.5886,3.0649,5.4739,0,5.1552,0,0,2.56,0,3.8574,0,0,0,4.7588,1.5527],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,1,0,0,1,0,1,1,1,0,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0.5488,0,0.6505,0,0.5488,1.4477,0,0,0,3.8574,0,3.2544,0,0,0.4493,0,1.0513,5.0531,0.4493,0,0,0,0.4493,0,5.2593,0,6.2339,0.8521,0,0,0.6505,2.2479,0.6505,0,14.2963,0.6505,0,0.4493,0,0,1.0513,4.2631,0,0,1.6487,0,0,0,0,6.7531,4.7588,8.2482,0,0.6505,3.7434,0.6505,0,0.4493,3.7434,0,1.2461,3.2544,6.7531,11.2459,1.6487,0,13.1971,1.4477,1.2461,10.2779,1.7507,5.7546,2.2479,10.2779,0,1.3499,11.7048,2.2479,0,0,3.7434,8.7583,11.7048,4.7588,18.1741],[6,7,7,6,6,6,6,6,7,6,6,6,7,7,7,6,7,6,6,7,6,7,6,7,6,6,7,7,7,6,6,6,6,6,6,7,8,7,7,7,8,7,6,7,7,7,8,7,6,6,7,6,7,7,8,7,7,6,8,7,6,7,8,7,6,7,7,7,6,7,7,7,7,8,8,6,8,8,7,8,7,7,7,8,8,8,6,7,8,8,6,7,8,8,8,8,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>patient_id<\/th>\n      <th>psa_level<\/th>\n      <th>cancer_vol<\/th>\n      <th>weight<\/th>\n      <th>age<\/th>\n      <th>benign_prostatic_hyperplasia<\/th>\n      <th>seminal_vesicle_invasion<\/th>\n      <th>capsular_penetration<\/th>\n      <th>gleason_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"scrollX":false,"columnDefs":[{"width":"50px","targets":"_all"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8]}],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Check summary statistic for each variable:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_summary<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">apply</span>(data,<span class="dv">2</span>,summary))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(data_summary, <span class="at">caption =</span> <span class="st">&#39;Table 2: Data Summary&#39;</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">9</span>, <span class="at">scrollX=</span>F))</span></code></pre></div>
<div id="htmlwidget-a021a4be3707a7a007d1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a021a4be3707a7a007d1">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 2: Data Summary<\/caption>","data":[["Min.","1st Qu.","Median","Mean","3rd Qu.","Max."],[1,25,49,49,73,97],[0.651,5.641,13.33,23.7301340206186,21.328,265.072],[0.2592,1.6653,4.2631,6.9986824742268,8.4149,45.6042],[10.697,29.371,37.338,45.4913608247423,48.424,450.339],[41,60,65,63.8659793814433,68,79],[0,0,1.3499,2.53472474226804,4.7588,10.2779],[0,0,0,0.216494845360825,0,1],[0,0,0.4493,2.24536701030928,3.2544,18.1741],[6,6,7,6.87628865979381,7,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>patient_id<\/th>\n      <th>psa_level<\/th>\n      <th>cancer_vol<\/th>\n      <th>weight<\/th>\n      <th>age<\/th>\n      <th>benign_prostatic_hyperplasia<\/th>\n      <th>seminal_vesicle_invasion<\/th>\n      <th>capsular_penetration<\/th>\n      <th>gleason_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":9,"scrollX":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[9,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">##check for variable types </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span><span class="fu">sapply</span>(data, class)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data_types<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(s)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(data_types,  <span class="at">caption =</span> <span class="st">&#39;Table 3: Data Types I&#39;</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span>,<span class="at">colnames =</span> <span class="st">&quot;Type&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-050694d537a6e7493663" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-050694d537a6e7493663">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 3: Data Types I<\/caption>","data":[["patient_id","psa_level","cancer_vol","weight","age","benign_prostatic_hyperplasia","seminal_vesicle_invasion","capsular_penetration","gleason_score"],["integer","numeric","numeric","numeric","integer","numeric","integer","numeric","integer"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Check number of missing values for each variable</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">sapply</span>(data, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>missing_<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(missing_,  <span class="at">caption =</span> <span class="st">&#39;Table 4: Missing Values&#39;</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span>,<span class="at">colnames =</span> <span class="st">&quot;NA&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-f15eec03f531272c6a58" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f15eec03f531272c6a58">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 4: Missing Values<\/caption>","data":[["patient_id","psa_level","cancer_vol","weight","age","benign_prostatic_hyperplasia","seminal_vesicle_invasion","capsular_penetration","gleason_score"],[0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>NA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Drop irrelevant variable: patient_id </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>drops<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;patient_id&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>prostate<span class="ot">=</span>data[,<span class="sc">!</span>(<span class="fu">names</span>(data)<span class="sc">%in%</span>drops)]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##Change variables to categorical</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>prostate<span class="sc">$</span>gleason_score <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(prostate<span class="sc">$</span>gleason_score) </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>prostate<span class="sc">$</span>seminal_vesicle_invasion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(prostate<span class="sc">$</span>seminal_vesicle_invasion) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">##recheck variable types </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span><span class="fu">sapply</span>(prostate, class)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data_types1<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(v)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(data_types1,  <span class="at">caption =</span> <span class="st">&#39;Table 3: Data Types II&#39;</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span>,<span class="at">colnames =</span> <span class="st">&quot;Type&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-946e37aa53041a932f70" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-946e37aa53041a932f70">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 3: Data Types II<\/caption>","data":[["psa_level","cancer_vol","weight","age","benign_prostatic_hyperplasia","seminal_vesicle_invasion","capsular_penetration","gleason_score"],["numeric","numeric","numeric","integer","numeric","factor","numeric","factor"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="data-visualization" class="section level4">
<h4>DATA VISUALIZATION</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Pie charts (with class percentage) for seminal_vesicle_invasion</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#table(prostate$seminal_vesicle_invasion)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#levels(prostate$seminal_vesicle_invasion)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(prostate)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>svi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Seminal&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Absence&quot;</span>, <span class="st">&quot;Presence&quot;</span>), <span class="st">&quot;Count&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">21</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#FC8D62&#39;</span>, <span class="st">&quot;#8DA0CB&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(svi, <span class="at">labels =</span> <span class="sc">~</span>Seminal, <span class="at">values =</span> <span class="sc">~</span>Count, <span class="at">type =</span> <span class="st">&#39;pie&#39;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">&#39;inside&#39;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">&#39;label+percent&#39;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">insidetextfont =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#FFFFFF&#39;</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">&#39;text&#39;</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(Count),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> colors,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#FFFFFF&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>)),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#The &#39;pull&#39; attribute can also be used to create space between the sectors</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>(fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&#39;Figure 1: Seminal Vesicle Invasion&#39;</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">showgrid =</span> <span class="cn">FALSE</span>, <span class="at">zeroline =</span> <span class="cn">FALSE</span>, <span class="at">showticklabels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">showgrid =</span> <span class="cn">FALSE</span>, <span class="at">zeroline =</span> <span class="cn">FALSE</span>, <span class="at">showticklabels =</span> <span class="cn">FALSE</span>)))</span></code></pre></div>
<div id="htmlwidget-d71f205b8497ae2e24ec" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d71f205b8497ae2e24ec">{"x":{"visdat":{"5f58192fe70":["function () ","plotlyVisDat"]},"cur_data":"5f58192fe70","attrs":{"5f58192fe70":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","insidetextfont":{"color":"#FFFFFF"},"hoverinfo":"text","text":{},"marker":{"colors":["#FC8D62","#8DA0CB"],"line":{"color":"#FFFFFF","width":1}},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Figure 1: Seminal Vesicle Invasion","xaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"yaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"labels":["Absence","Presence"],"values":[76,21],"textposition":["inside","inside"],"textinfo":"label+percent","insidetextfont":{"color":"#FFFFFF"},"hoverinfo":["text","text"],"text":["76","21"],"marker":{"color":"rgba(31,119,180,1)","colors":["#FC8D62","#8DA0CB"],"line":{"color":"#FFFFFF","width":1}},"showlegend":false,"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Pie charts (with class percentage) for gleason_score</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#table(prostate$gleason_score)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#levels(prostate$gleason_score)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Gleason&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Bad Prognosis (6)&quot;</span>,<span class="st">&quot;Worse Prognosis (7)&quot;</span>, <span class="st">&quot;Worst Prognosis (8)&quot;</span>), <span class="st">&quot;count&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span> , <span class="dv">43</span>, <span class="dv">21</span>  ))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#khaki&#39;</span>, <span class="st">&quot;palegreen&quot;</span>, <span class="st">&quot;plum&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(gs, <span class="at">labels =</span> <span class="sc">~</span>Gleason, <span class="at">values =</span> <span class="sc">~</span>count, <span class="at">type =</span> <span class="st">&#39;pie&#39;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">&#39;inside&#39;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">&#39;label+percent&#39;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">insidetextfont =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#FFFFFF&#39;</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">&#39;text&#39;</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(count),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> colors,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#FFFFFF&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>)),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#The &#39;pull&#39; attribute can also be used to create space between the sectors</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>(fig1 <span class="ot">&lt;-</span> fig1 <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&#39;Figure 2: Gleason Score&#39;</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">showgrid =</span> <span class="cn">FALSE</span>, <span class="at">zeroline =</span> <span class="cn">FALSE</span>, <span class="at">showticklabels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">showgrid =</span> <span class="cn">FALSE</span>, <span class="at">zeroline =</span> <span class="cn">FALSE</span>, <span class="at">showticklabels =</span> <span class="cn">FALSE</span>)))</span></code></pre></div>
<div id="htmlwidget-5bc06f27a27a5816f9ea" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5bc06f27a27a5816f9ea">{"x":{"visdat":{"5f5814941125":["function () ","plotlyVisDat"]},"cur_data":"5f5814941125","attrs":{"5f5814941125":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","insidetextfont":{"color":"#FFFFFF"},"hoverinfo":"text","text":{},"marker":{"colors":["#khaki","palegreen","plum"],"line":{"color":"#FFFFFF","width":1}},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Figure 2: Gleason Score","xaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"yaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"labels":["Bad Prognosis (6)","Worse Prognosis (7)","Worst Prognosis (8)"],"values":[33,43,21],"textposition":["inside","inside","inside"],"textinfo":"label+percent","insidetextfont":{"color":"#FFFFFF"},"hoverinfo":["text","text","text"],"text":["33","43","21"],"marker":{"color":"rgba(31,119,180,1)","colors":["#khaki","palegreen","plum"],"line":{"color":"#FFFFFF","width":1}},"showlegend":false,"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Histograms of each quantitative variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">##function to combine plots in one panel</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>multiplot <span class="ot">&lt;-</span> <span class="cf">function</span>(..., <span class="at">plotlist=</span><span class="cn">NULL</span>, file, <span class="at">cols=</span><span class="dv">1</span>, <span class="at">layout=</span><span class="cn">NULL</span>) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(grid)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a list from the ... arguments and plotlist</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(...), plotlist)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  numPlots <span class="ot">=</span> <span class="fu">length</span>(plots)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If layout is NULL, then use &#39;cols&#39; to determine layout</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(layout)) {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make the panel</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ncol: Number of columns of plots</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nrow: Number of rows needed, calculated from # of cols</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    layout <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, cols <span class="sc">*</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols)),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> cols, <span class="at">nrow =</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (numPlots<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plots[[<span class="dv">1</span>]])</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the page</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grid.newpage</span>()</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="fu">nrow</span>(layout), <span class="fu">ncol</span>(layout))))</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make each plot, in the correct location</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlots) {</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the i,j matrix positions of the regions that contain this subplot</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>      matchidx <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(layout <span class="sc">==</span> i, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(plots[[i]], <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> matchidx<span class="sc">$</span>row,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">layout.pos.col =</span> matchidx<span class="sc">$</span>col))</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 1 - PSA level</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>ggp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> psa_level)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;PSA Level&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>psa_level), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>) </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 2 - Cancer Volume</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>ggp2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> cancer_vol)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Cancer Volume&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>cancer_vol), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 3 - Weight</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>ggp3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>weight), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 4 - age</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>ggp4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Age&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>age), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 5 - Benign prostatic Hyperplasia</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>ggp5<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> benign_prostatic_hyperplasia)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Benign Prostatic Hyperplasia&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>benign_prostatic_hyperplasia), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 6 - Capsular Penetration</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>ggp6<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> capsular_penetration)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Capsular Penetration&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(prostate<span class="sc">$</span>capsular_penetration), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>myplots <span class="ot">&lt;-</span> <span class="fu">list</span>(ggp1, ggp2, ggp3, ggp4, ggp5, ggp6) </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(<span class="at">plotlist =</span> myplots, <span class="at">cols =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 3: Histograms of quantitative variables" width="768" />
<p class="caption">
Figure 3: Histograms of quantitative variables
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Transform PSA level to eliminate right skewed distribution shown in Figure 3 </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">##Box-cox transformation</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">&lt;-</span><span class="fu">lm</span>(psa_level<span class="sc">~</span>., <span class="at">data=</span>prostate) <span class="co">#first-order model with the (non-transformed) variables</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1,<span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 4" width="768" />
<p class="caption">
Figure 4
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">###The Box-Cox likelihood suggests a power transformation with power -0.1.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>bc<span class="ot">&lt;-</span>MASS<span class="sc">::</span><span class="fu">boxcox</span>(fit1, <span class="at">plotit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#with(prostate, boxCox(fit1, data = prostate, main= &quot;&quot;))</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(prostate, <span class="fu">boxCox</span>(fit1, <span class="at">data =</span> prostate, <span class="at">main=</span> <span class="st">&quot;&quot;</span>, <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="at">length =</span> <span class="dv">10</span>))) <span class="co">#zoomed in</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-7-1.png" alt="Figure 5: Log-likelihood" width="768" />
<p class="caption">
Figure 5: Log-likelihood
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(lambda <span class="ot">&lt;-</span> bc<span class="sc">$</span>x[<span class="fu">which.max</span>(bc<span class="sc">$</span>y)]) <span class="co">#optimal lambda</span></span></code></pre></div>
<pre><code>## [1] 0.1010101</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##psa_level transformation </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ggp0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> psa_level<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.1</span>))) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Histogram of psa_level^(-0.1))&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;gold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(prostate<span class="sc">$</span>psa_level<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.1</span>)),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(prostate<span class="sc">$</span>psa_level<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.1</span>))),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>ggp7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(psa_level))) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Histogram of log(psa_level)&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;rosybrown&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(<span class="fu">log</span>(prostate<span class="sc">$</span>psa_level)),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(<span class="fu">log</span>(prostate<span class="sc">$</span>psa_level))),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 2 - Cancer Volume</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>ggp8<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">sqrt</span>(psa_level))) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Histogram of sqrt(psa_level)&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;springgreen&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(<span class="fu">sqrt</span>(prostate<span class="sc">$</span>psa_level)),</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(<span class="fu">sqrt</span>(prostate<span class="sc">$</span>psa_level))),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>) </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 3 - Weight</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>ggp9<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">/</span>psa_level)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Histogram of 1/psa_level&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;darkmagenta&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)  <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>prostate<span class="sc">$</span>psa_level),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(<span class="dv">1</span><span class="sc">/</span>prostate<span class="sc">$</span>psa_level)),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>) </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>myplots2 <span class="ot">&lt;-</span> <span class="fu">list</span>(ggp0,ggp7, ggp8, ggp9) </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(<span class="at">plotlist =</span> myplots2, <span class="at">cols =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-8-1.png" alt="Figure 6: Histograms of PSA Level Transformations" width="768" />
<p class="caption">
Figure 6: Histograms of PSA Level Transformations
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Based on Figure 6, the best transformation is log(psa_level) </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>prostate<span class="sc">$</span>psa_level<span class="ot">&lt;-</span><span class="fu">log</span>(prostate<span class="sc">$</span>psa_level)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Model diagnostic - after variable transformation </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span><span class="fu">lm</span>(psa_level<span class="sc">~</span>., <span class="at">data=</span>prostate) <span class="co">#first-order model with the (transformed) variable</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2,<span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-9-1.png" alt="Figure 7" width="768" />
<p class="caption">
Figure 7
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">##scatter plot matrix among quantitative variables with the lower panel showing correlation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation panel</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#usr &lt;- par(&#39;usr&#39;) on.exit(par(usr))</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(x, y, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>), <span class="dv">2</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;R = &quot;</span>, r)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor <span class="sc">*</span> r)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize upper panel</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>upper.panel<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#my_cols &lt;- c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;) </span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plots</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="sc">~</span>psa_level <span class="sc">+</span> cancer_vol <span class="sc">+</span> weight <span class="sc">+</span> age <span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> capsular_penetration, <span class="at">data =</span> prostate,<span class="at">lower.panel =</span> panel.cor, <span class="at">upper.panel =</span> upper.panel)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-10-1.png" alt="Figure 8: Correlation Plot I" width="768" />
<p class="caption">
Figure 8: Correlation Plot I
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Scatter plot 2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p &lt;- ggpairs(dat_psa)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># put scatterplots on top so y axis is vertical</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">ggpairs</span>(prostate <span class="sc">%&gt;%</span> <span class="fu">select</span>(psa_level, cancer_vol, weight, age, benign_prostatic_hyperplasia, capsular_penetration)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">#, upper = list(continuous = wrap(&quot;points&quot;, alpha = 0.2, size = 0.5))</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>            , <span class="fu">aes</span>(<span class="at">color =</span> prostate<span class="sc">$</span>seminal_vesicle_invasion)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            , <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;points&quot;</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>            , <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;cor&quot;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>            ))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-11-1.png" alt="Figure 9: Correlation Plot II" width="768" />
<p class="caption">
Figure 9: Correlation Plot II
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Pairwise correlation matrix for all quantitative variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>quantitative<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;cancer_vol&#39;</span>,<span class="st">&#39;weight&#39;</span>,<span class="st">&#39;age&#39;</span>,<span class="st">&#39;benign_prostatic_hyperplasia&#39;</span> , <span class="st">&#39;capsular_penetration&#39;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span><span class="fu">cor</span>(prostate[,<span class="fu">c</span>(<span class="st">&quot;psa_level&quot;</span>,quantitative)], <span class="at">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>corr_df<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(c)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>cd<span class="ot">&lt;-</span><span class="fu">as.datatable</span>(<span class="fu">formattable</span>(corr_df, <span class="fu">list</span>(<span class="fu">area</span>(<span class="at">col =</span> <span class="fu">c</span>(psa_level, cancer_vol, weight, age, benign_prostatic_hyperplasia, capsular_penetration)) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">width=</span><span class="dv">200</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">6</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX=</span>T, <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">width =</span> <span class="st">&#39;50px&#39;</span>, <span class="at">targets =</span> <span class="st">&quot;_all&quot;</span>)))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>cd</span></code></pre></div>
<div class="figure">
<div id="htmlwidget-4947e73bf87f39a8eea2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4947e73bf87f39a8eea2">{"x":{"filter":"none","vertical":false,"data":[["psa_level","cancer_vol","weight","age","benign_prostatic_hyperplasia","capsular_penetration"],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.0000000<\/span>   ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc04d\">0.6570739<\/span>   ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeac5\">0.1217208<\/span>   ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe6ba\">0.1699068<\/span>   ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bd\">0.1574016<\/span>   ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffcb6c\">0.5180231<\/span>   "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc04d\">0.657073936<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.000000000<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4df\">0.005107148<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff1d8\">0.039094423<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">-0.133209431<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbd45\">0.692896688<\/span> "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeac5\">0.121720757<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4df\">0.005107148<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.000000000<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bc\">0.164323714<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffda98\">0.321848748<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4e0\">0.001578905<\/span> "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe6ba\">0.16990682<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff1d8\">0.03909442<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bc\">0.16432371<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.00000000<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd78e\">0.36634121<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffecca\">0.09955535<\/span>  "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bd\">0.15740158<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">-0.13320943<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffda98\">0.32184875<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd78e\">0.36634121<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.00000000<\/span>  ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf3\">-0.08300865<\/span> "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffcb6c\">0.518023108<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbd45\">0.692896688<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4e0\">0.001578905<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffecca\">0.099555351<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf3\">-0.083008649<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500\">1.000000000<\/span> "]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>psa_level<\/th>\n      <th>cancer_vol<\/th>\n      <th>weight<\/th>\n      <th>age<\/th>\n      <th>benign_prostatic_hyperplasia<\/th>\n      <th>capsular_penetration<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Table 5: Pairwise correlation matrix
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">##side-by-side box plots for ”PSA” with respect to each categorical variable</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fig4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(prostate, <span class="at">y =</span> <span class="sc">~</span>psa_level, <span class="at">color =</span> <span class="sc">~</span>gleason_score, <span class="at">type =</span> <span class="st">&quot;box&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fig5 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(prostate, <span class="at">y =</span> <span class="sc">~</span>psa_level, <span class="at">color =</span> <span class="sc">~</span>seminal_vesicle_invasion, <span class="at">type =</span> <span class="st">&quot;box&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># subplot</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>fig6 <span class="ot">&lt;-</span> <span class="fu">subplot</span>(fig4, fig5, <span class="at">nrows =</span> <span class="dv">1</span>) </span></code></pre></div>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig6 <span class="ot">&lt;-</span> fig6 <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;PSA Level: Side-by-Side Boxplot by Gleason Score (Left) and Seminal Vesicle Invasion (Right)&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fig6</span></code></pre></div>
<div id="htmlwidget-f56f027c3063b1de4f5a" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f56f027c3063b1de4f5a">{"x":{"data":[{"fillcolor":"rgba(102,194,165,0.5)","y":[-0.429245636773568,-0.160168752152821,0.370183293963525,0.770108221696074,0.770108221696074,0.85015092936961,1.05012207950768,1.27004140429564,1.27004140429564,1.44997313778307,1.48997847239677,1.56003756213897,1.63996711746892,1.70000961061849,1.73006135475784,1.77002497708205,1.88994430113679,1.92000608867258,2.00995747814925,2.00995747814925,2.01995689484494,2.05001273098902,2.33000568857004,2.59001713419062,2.59001713419062,2.67999360331968,2.78999878374938,2.84001369855457,2.87998466500968,2.96000146359819,3.33999550993571,3.67999006026802,4.03000157752159],"type":"box","name":"6","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","y":[-0.160168752152821,-0.160168752152821,1.05012207950768,1.27004140429564,1.34988967922609,1.39995068756738,1.4699459336155,1.5999934536061,1.65994089460721,1.7100069673558,1.80005827204275,1.82002293450091,1.85002837735203,2.09001049302907,2.18997614861139,2.21003111138344,2.28003268852353,2.30995784732346,2.36996332832399,2.52003245176337,2.54999189644393,2.57001343641856,2.65997977785713,2.67999360331968,2.69002199858282,2.71997877196748,2.78999878374938,2.8100049236252,2.85001261920458,2.87998466500968,2.88998279337038,2.91998449611572,2.96000146359819,2.97000412498126,3.00998028681919,3.03998836480853,3.06002076343635,3.46000073813813,3.51998731763164,3.53000094904645,3.57001145509761,3.71000473572888,4.13000123943014],"type":"box","name":"7","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","y":[2.15998412439502,2.29998170712393,2.57001343641856,2.70001802940495,2.8100049236252,2.85001261920458,3.07998150599889,3.28000855287094,3.39000160890142,3.44000134131909,3.50999199405426,3.57001145509761,3.58999790455382,3.6300048626008,3.97999936043724,3.99000204674473,4.38999480432306,4.67999932660874,5.14000135710088,5.48000122005246,5.58000148719618],"type":"box","name":"8","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(102,194,165,0.5)","y":[-0.429245636773568,-0.160168752152821,-0.160168752152821,-0.160168752152821,0.370183293963525,0.770108221696074,0.770108221696074,0.85015092936961,1.05012207950768,1.05012207950768,1.27004140429564,1.27004140429564,1.27004140429564,1.34988967922609,1.39995068756738,1.44997313778307,1.4699459336155,1.48997847239677,1.56003756213897,1.5999934536061,1.63996711746892,1.65994089460721,1.70000961061849,1.7100069673558,1.73006135475784,1.77002497708205,1.80005827204275,1.82002293450091,1.85002837735203,1.88994430113679,1.92000608867258,2.00995747814925,2.00995747814925,2.01995689484494,2.05001273098902,2.09001049302907,2.15998412439502,2.18997614861139,2.28003268852353,2.29998170712393,2.30995784732346,2.33000568857004,2.36996332832399,2.52003245176337,2.54999189644393,2.57001343641856,2.59001713419062,2.59001713419062,2.65997977785713,2.67999360331968,2.67999360331968,2.69002199858282,2.70001802940495,2.71997877196748,2.78999878374938,2.78999878374938,2.8100049236252,2.8100049236252,2.84001369855457,2.85001261920458,2.87998466500968,2.88998279337038,2.91998449611572,2.96000146359819,2.96000146359819,2.97000412498126,3.03998836480853,3.39000160890142,3.44000134131909,3.50999199405426,3.51998731763164,3.53000094904645,3.57001145509761,3.58999790455382,3.67999006026802,4.03000157752159],"type":"box","name":"0","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","y":[2.21003111138344,2.57001343641856,2.85001261920458,2.87998466500968,3.00998028681919,3.06002076343635,3.07998150599889,3.28000855287094,3.33999550993571,3.46000073813813,3.57001145509761,3.6300048626008,3.71000473572888,3.97999936043724,3.99000204674473,4.13000123943014,4.38999480432306,4.67999932660874,5.14000135710088,5.48000122005246,5.58000148719618],"type":"box","name":"1","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.48],"automargin":true,"anchor":"y"},"xaxis2":{"domain":[0.52,1],"automargin":true,"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"PSA Level: Side-by-Side Boxplot by Gleason Score (Left) and Seminal Vesicle Invasion (Right)"},"attrs":{"5f58428a10a0":{"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"5f586fda701f":{"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">##plot the distribution of PSA level </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">##by seminal invasion in using kernel density plots</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ggp7<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> psa_level, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> seminal_vesicle_invasion)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;PSA Level distribution by Seminal Vesicle Invasion&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>ggp8<span class="ot">&lt;-</span><span class="fu">ggplot</span>(prostate, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> psa_level, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> gleason_score)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;PSA Level distribution by Gleason Score&quot;</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>myplots1 <span class="ot">&lt;-</span> <span class="fu">list</span>(ggp7, ggp8) </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(<span class="at">plotlist =</span> myplots1, <span class="at">cols =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-13-2.png" width="768" /></p>
<p><strong>Observations:</strong></p>
<ul>
<li><p>PSA level increases from low to high gleason score and from absence to presence of seminal vesicle invasion</p></li>
<li><p>There are no obvious nonlinearity</p></li>
<li><p>The Box-Cox likelihood suggests a power transformation with power -0.1 which produces similar results as log transformation of response variable so we can use either one</p></li>
<li><p>R-squared increases from Model 1 to Model 2 after log transformation</p></li>
</ul>
<hr />
</div>
</div>
<div id="part-ii-multiple-regression-with-categorical-variables" class="section level3">
<h3>Part II: Multiple Regression with Categorical Variables</h3>
<ul>
<li>Response variable: psa_level</li>
<li>Predictor variables: cancer_vol, weight, age, benign_prostatic_hyperplasia, seminal_vesicle_invasion, capsular_penetration, gleason_score</li>
<li>Fit model with interactions.</li>
<li>Compare the two models using the function anova()</li>
<li>Construct a 95% prediction interval of PSA</li>
<li>Determine which variables are not significant</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Preliminary Model Fitting</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1) <span class="co">#model with all predictors (non-transformed psa_level) from Part I</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ ., data = prostate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -68.153  -7.323  -0.177   6.403 161.547 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                  31.849265  28.958981   1.100  0.27442   
## cancer_vol                    1.748107   0.615858   2.838  0.00563 **
## weight                       -0.004546   0.074038  -0.061  0.95118   
## age                          -0.537278   0.471991  -1.138  0.25808   
## benign_prostatic_hyperplasia  1.530782   1.201007   1.275  0.20581   
## seminal_vesicle_invasion1    21.108723  10.844893   1.946  0.05479 . 
## capsular_penetration          1.097882   1.322879   0.830  0.40883   
## gleason_score7               -1.661862   7.570741  -0.220  0.82676   
## gleason_score8               18.423157  10.661795   1.728  0.08750 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 30.91 on 88 degrees of freedom
## Multiple R-squared:  0.4733, Adjusted R-squared:  0.4254 
## F-statistic: 9.886 on 8 and 88 DF,  p-value: 1.037e-09</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2) <span class="co">#model with all predictors (transformed psa_level) from part I</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ ., data = prostate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.85118 -0.45409  0.07018  0.45549  1.50935 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.496462   0.722596   2.071  0.04129 *  
## cancer_vol                    0.067454   0.015367   4.389 3.15e-05 ***
## weight                        0.001268   0.001847   0.687  0.49419    
## age                          -0.002799   0.011777  -0.238  0.81267    
## benign_prostatic_hyperplasia  0.089106   0.029968   2.973  0.00380 ** 
## seminal_vesicle_invasion1     0.793175   0.270606   2.931  0.00430 ** 
## capsular_penetration         -0.026527   0.033009  -0.804  0.42378    
## gleason_score7                0.296768   0.188908   1.571  0.11978    
## gleason_score8                0.746606   0.266037   2.806  0.00617 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7714 on 88 degrees of freedom
## Multiple R-squared:  0.5902, Adjusted R-squared:  0.5529 
## F-statistic: 15.84 on 8 and 88 DF,  p-value: 3.135e-14</code></pre>
<p><em>Observations:</em></p>
<ul>
<li>First order model (fit2 - includes all predictors): <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>, and <span class="math inline">\(\beta_6\)</span> are not significant <span class="math display">\[H_0:\beta_2=0~~vs.~~H_a:\beta_2\neq0,~T^*=0.687, ~Under H_0, T^*\sim t_{(88)}, p-value=0.49419\]</span> <span class="math display">\[H_0:\beta_3=0~~vs.~~H_a:\beta_3\neq0,~T^*=-0.238, ~Under H_0, T^*\sim t_{(88)}, p-value=0.81267\]</span> <span class="math display">\[H_0:\beta_6=0~~vs.~~H_a:\beta_6\neq0,~T^*=-0.804 , ~Under H_0, T^*\sim t_{(88)}, p-value=0.42378 \]</span></li>
<li>Log transformation of response variable increased <span class="math inline">\(R^2\)</span></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Check for multicollinearity in this data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">##Variance inflation factors VIF_k</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain R-squared_k by regressing X_k to {X_j : 1≤j not equal to k≤4} (k = 1, 2, 3, 4)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>(vif_1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(cancer_vol<span class="sc">~</span>weight<span class="sc">+</span>age<span class="sc">+</span>benign_prostatic_hyperplasia<span class="sc">+</span>capsular_penetration, <span class="at">data =</span> prostate))<span class="sc">$</span>r.squared)))</span></code></pre></div>
<pre><code>## [1] 1.948535</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(vif_2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(weight<span class="sc">~</span>cancer_vol<span class="sc">+</span>age<span class="sc">+</span>benign_prostatic_hyperplasia<span class="sc">+</span>capsular_penetration, <span class="at">data =</span> prostate))<span class="sc">$</span>r.squared)))</span></code></pre></div>
<pre><code>## [1] 1.121247</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(vif_3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(age<span class="sc">~</span>cancer_vol<span class="sc">+</span>weight<span class="sc">+</span>benign_prostatic_hyperplasia<span class="sc">+</span>capsular_penetration, <span class="at">data =</span> prostate))<span class="sc">$</span>r.squared)))</span></code></pre></div>
<pre><code>## [1] 1.181007</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(vif_4 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(benign_prostatic_hyperplasia<span class="sc">~</span>cancer_vol<span class="sc">+</span>weight<span class="sc">+</span>age<span class="sc">+</span>capsular_penetration, <span class="at">data =</span> prostate))<span class="sc">$</span>r.squared)))</span></code></pre></div>
<pre><code>## [1] 1.293057</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(vif_5 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(capsular_penetration<span class="sc">~</span>cancer_vol<span class="sc">+</span>weight<span class="sc">+</span>age<span class="sc">+</span> benign_prostatic_hyperplasia, <span class="at">data =</span> prostate))<span class="sc">$</span>r.squared)))</span></code></pre></div>
<pre><code>## [1] 1.944823</code></pre>
<ul>
<li>All five VIF values are a higher than 1 and far less than 10, so we can conclude that there is not much multicollinearity in the model</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">##First order model with significant X variables</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fit3a <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> cancer_vol <span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> seminal_vesicle_invasion , <span class="at">data=</span>prostate)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3a)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9867 -0.4996  0.1032  0.5545  1.4993 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.51484    0.13206  11.471  &lt; 2e-16 ***
## cancer_vol                    0.07618    0.01256   6.067 2.78e-08 ***
## benign_prostatic_hyperplasia  0.09971    0.02674   3.729 0.000331 ***
## seminal_vesicle_invasion1     0.82194    0.23858   3.445 0.000858 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7861 on 93 degrees of freedom
## Multiple R-squared:  0.5502, Adjusted R-squared:  0.5357 
## F-statistic: 37.92 on 3 and 93 DF,  p-value: 4.247e-16</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit3aa <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> cancer_vol <span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> seminal_vesicle_invasion <span class="sc">+</span>gleason_score, <span class="at">data=</span>prostate)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3aa)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + gleason_score, data = prostate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.85235 -0.45777  0.06741  0.51651  1.53204 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.38817    0.15609   8.894 5.27e-14 ***
## cancer_vol                    0.06241    0.01367   4.566 1.55e-05 ***
## benign_prostatic_hyperplasia  0.09265    0.02627   3.527  0.00066 ***
## seminal_vesicle_invasion1     0.69646    0.23837   2.922  0.00439 ** 
## gleason_score7                0.26028    0.18280   1.424  0.15790    
## gleason_score8                0.70545    0.25712   2.744  0.00732 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7636 on 91 degrees of freedom
## Multiple R-squared:  0.5848, Adjusted R-squared:  0.5619 
## F-statistic: 25.63 on 5 and 91 DF,  p-value: 4.722e-16</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Model with two-way interactions (significant predictors)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>drops1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;weight&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;capsular_penetration&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>pd<span class="ot">=</span>prostate[,<span class="sc">!</span>(<span class="fu">names</span>(prostate)<span class="sc">%in%</span>drops1)]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>fit3b <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>pd)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ .^2, data = pd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.71044 -0.41531 -0.00348  0.48621  1.80370 
## 
## Coefficients:
##                                                         Estimate Std. Error
## (Intercept)                                             1.080795   0.202661
## cancer_vol                                              0.118417   0.027680
## benign_prostatic_hyperplasia                            0.141754   0.052268
## seminal_vesicle_invasion1                              -0.004472   1.263746
## gleason_score7                                          0.410471   0.312494
## gleason_score8                                          1.197254   0.518413
## cancer_vol:benign_prostatic_hyperplasia                 0.001194   0.008732
## cancer_vol:seminal_vesicle_invasion1                   -0.020573   0.036158
## cancer_vol:gleason_score7                              -0.020164   0.053961
## cancer_vol:gleason_score8                              -0.073630   0.042757
## benign_prostatic_hyperplasia:seminal_vesicle_invasion1 -0.166088   0.090083
## benign_prostatic_hyperplasia:gleason_score7            -0.053534   0.062762
## benign_prostatic_hyperplasia:gleason_score8            -0.052336   0.105125
## seminal_vesicle_invasion1:gleason_score7                1.141611   1.178306
## seminal_vesicle_invasion1:gleason_score8                1.493889   1.077867
##                                                        t value Pr(&gt;|t|)    
## (Intercept)                                              5.333 8.36e-07 ***
## cancer_vol                                               4.278 5.07e-05 ***
## benign_prostatic_hyperplasia                             2.712  0.00814 ** 
## seminal_vesicle_invasion1                               -0.004  0.99719    
## gleason_score7                                           1.314  0.19267    
## gleason_score8                                           2.309  0.02343 *  
## cancer_vol:benign_prostatic_hyperplasia                  0.137  0.89159    
## cancer_vol:seminal_vesicle_invasion1                    -0.569  0.57093    
## cancer_vol:gleason_score7                               -0.374  0.70962    
## cancer_vol:gleason_score8                               -1.722  0.08883 .  
## benign_prostatic_hyperplasia:seminal_vesicle_invasion1  -1.844  0.06884 .  
## benign_prostatic_hyperplasia:gleason_score7             -0.853  0.39616    
## benign_prostatic_hyperplasia:gleason_score8             -0.498  0.61992    
## seminal_vesicle_invasion1:gleason_score7                 0.969  0.33547    
## seminal_vesicle_invasion1:gleason_score8                 1.386  0.16951    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7489 on 82 degrees of freedom
## Multiple R-squared:  0.6401, Adjusted R-squared:  0.5787 
## F-statistic: 10.42 on 14 and 82 DF,  p-value: 5.1e-13</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Model with two-way interactions </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fit3b <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>prostate)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ .^2, data = prostate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6692 -0.2934  0.0000  0.3874  1.6488 
## 
## Coefficients:
##                                                         Estimate Std. Error
## (Intercept)                                             4.233800   2.570730
## cancer_vol                                              0.303276   0.173336
## weight                                                 -0.086133   0.081243
## age                                                    -0.064713   0.042944
## benign_prostatic_hyperplasia                            0.389719   0.435132
## seminal_vesicle_invasion1                              -1.420907   4.851800
## capsular_penetration                                   -0.049000   0.546142
## gleason_score7                                         -0.030655   1.802806
## gleason_score8                                          3.454056   4.332597
## cancer_vol:weight                                      -0.002764   0.001897
## cancer_vol:age                                         -0.000597   0.002230
## cancer_vol:benign_prostatic_hyperplasia                 0.011300   0.010969
## cancer_vol:seminal_vesicle_invasion1                   -0.031776   0.069049
## cancer_vol:capsular_penetration                         0.005215   0.005983
## cancer_vol:gleason_score7                              -0.125014   0.087691
## cancer_vol:gleason_score8                              -0.130589   0.058787
## weight:age                                              0.001707   0.001286
## weight:benign_prostatic_hyperplasia                    -0.003891   0.001476
## weight:seminal_vesicle_invasion1                       -0.043008   0.052745
## weight:capsular_penetration                             0.003770   0.005860
## weight:gleason_score7                                   0.004122   0.010257
## weight:gleason_score8                                   0.020481   0.029580
## age:benign_prostatic_hyperplasia                       -0.001387   0.006858
## age:seminal_vesicle_invasion1                           0.068016   0.076388
## age:capsular_penetration                               -0.004708   0.009147
## age:gleason_score7                                      0.009721   0.029847
## age:gleason_score8                                     -0.048420   0.079074
## benign_prostatic_hyperplasia:seminal_vesicle_invasion1  0.129029   0.180185
## benign_prostatic_hyperplasia:capsular_penetration      -0.034542   0.021356
## benign_prostatic_hyperplasia:gleason_score7            -0.066955   0.082549
## benign_prostatic_hyperplasia:gleason_score8            -0.057507   0.145909
## seminal_vesicle_invasion1:capsular_penetration         -0.135395   0.120265
## seminal_vesicle_invasion1:gleason_score7                0.017252   2.245275
## seminal_vesicle_invasion1:gleason_score8                0.076708   2.105042
## capsular_penetration:gleason_score7                     0.274529   0.213993
## capsular_penetration:gleason_score8                     0.309074   0.212771
##                                                        t value Pr(&gt;|t|)  
## (Intercept)                                              1.647   0.1047  
## cancer_vol                                               1.750   0.0852 .
## weight                                                  -1.060   0.2932  
## age                                                     -1.507   0.1370  
## benign_prostatic_hyperplasia                             0.896   0.3740  
## seminal_vesicle_invasion1                               -0.293   0.7706  
## capsular_penetration                                    -0.090   0.9288  
## gleason_score7                                          -0.017   0.9865  
## gleason_score8                                           0.797   0.4284  
## cancer_vol:weight                                       -1.457   0.1503  
## cancer_vol:age                                          -0.268   0.7898  
## cancer_vol:benign_prostatic_hyperplasia                  1.030   0.3070  
## cancer_vol:seminal_vesicle_invasion1                    -0.460   0.6470  
## cancer_vol:capsular_penetration                          0.872   0.3868  
## cancer_vol:gleason_score7                               -1.426   0.1591  
## cancer_vol:gleason_score8                               -2.221   0.0300 *
## weight:age                                               1.327   0.1893  
## weight:benign_prostatic_hyperplasia                     -2.637   0.0106 *
## weight:seminal_vesicle_invasion1                        -0.815   0.4180  
## weight:capsular_penetration                              0.643   0.5224  
## weight:gleason_score7                                    0.402   0.6892  
## weight:gleason_score8                                    0.692   0.4913  
## age:benign_prostatic_hyperplasia                        -0.202   0.8404  
## age:seminal_vesicle_invasion1                            0.890   0.3768  
## age:capsular_penetration                                -0.515   0.6086  
## age:gleason_score7                                       0.326   0.7458  
## age:gleason_score8                                      -0.612   0.5426  
## benign_prostatic_hyperplasia:seminal_vesicle_invasion1   0.716   0.4767  
## benign_prostatic_hyperplasia:capsular_penetration       -1.617   0.1109  
## benign_prostatic_hyperplasia:gleason_score7             -0.811   0.4205  
## benign_prostatic_hyperplasia:gleason_score8             -0.394   0.6949  
## seminal_vesicle_invasion1:capsular_penetration          -1.126   0.2647  
## seminal_vesicle_invasion1:gleason_score7                 0.008   0.9939  
## seminal_vesicle_invasion1:gleason_score8                 0.036   0.9711  
## capsular_penetration:gleason_score7                      1.283   0.2044  
## capsular_penetration:gleason_score8                      1.453   0.1515  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7434 on 61 degrees of freedom
## Multiple R-squared:  0.7361, Adjusted R-squared:  0.5847 
## F-statistic: 4.862 on 35 and 61 DF,  p-value: 3.611e-08</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> cancer_vol <span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> seminal_vesicle_invasion <span class="sc">+</span> gleason_score<span class="sc">+</span> cancer_vol<span class="sc">:</span>benign_prostatic_hyperplasia <span class="sc">+</span> cancer_vol<span class="sc">:</span>seminal_vesicle_invasion <span class="sc">+</span> cancer_vol<span class="sc">:</span>gleason_score, <span class="at">data=</span>prostate)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + gleason_score + cancer_vol:benign_prostatic_hyperplasia + 
##     cancer_vol:seminal_vesicle_invasion + cancer_vol:gleason_score, 
##     data = prostate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.67536 -0.45692  0.05281  0.43829  1.70583 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                              1.188041   0.182582   6.507 4.71e-09
## cancer_vol                               0.103718   0.024185   4.289 4.64e-05
## benign_prostatic_hyperplasia             0.129957   0.040745   3.190  0.00198
## seminal_vesicle_invasion1                0.946895   0.418419   2.263  0.02612
## gleason_score7                           0.229407   0.253334   0.906  0.36767
## gleason_score8                           1.105168   0.404354   2.733  0.00760
## cancer_vol:benign_prostatic_hyperplasia -0.006877   0.005386  -1.277  0.20507
## cancer_vol:seminal_vesicle_invasion1    -0.025957   0.030557  -0.849  0.39795
## cancer_vol:gleason_score7                0.003900   0.041014   0.095  0.92446
## cancer_vol:gleason_score8               -0.039213   0.032541  -1.205  0.23146
##                                            
## (Intercept)                             ***
## cancer_vol                              ***
## benign_prostatic_hyperplasia            ** 
## seminal_vesicle_invasion1               *  
## gleason_score7                             
## gleason_score8                          ** 
## cancer_vol:benign_prostatic_hyperplasia    
## cancer_vol:seminal_vesicle_invasion1       
## cancer_vol:gleason_score7                  
## cancer_vol:gleason_score8                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7541 on 87 degrees of freedom
## Multiple R-squared:  0.6128, Adjusted R-squared:  0.5728 
## F-statistic:  15.3 on 9 and 87 DF,  p-value: 1.251e-14</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Polynomial Model</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> cancer_vol <span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> seminal_vesicle_invasion <span class="sc">+</span> gleason_score<span class="sc">+</span>cancer_vol<span class="sc">:</span>benign_prostatic_hyperplasia<span class="sc">+</span><span class="fu">I</span>(cancer_vol<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(benign_prostatic_hyperplasia<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>prostate)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + gleason_score + cancer_vol:benign_prostatic_hyperplasia + 
##     I(cancer_vol^2) + I(benign_prostatic_hyperplasia^2), data = prostate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.63690 -0.47919  0.09209  0.50902  1.74263 
## 
## Coefficients:
##                                           Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                              1.1369391  0.1834337   6.198 1.80e-08
## cancer_vol                               0.1272796  0.0304641   4.178 6.91e-05
## benign_prostatic_hyperplasia             0.1947783  0.0794516   2.452  0.01620
## seminal_vesicle_invasion1                0.6221195  0.2399560   2.593  0.01115
## gleason_score7                           0.2325434  0.1807751   1.286  0.20169
## gleason_score8                           0.6879983  0.2573059   2.674  0.00894
## I(cancer_vol^2)                         -0.0017616  0.0007775  -2.266  0.02592
## I(benign_prostatic_hyperplasia^2)       -0.0077762  0.0087863  -0.885  0.37855
## cancer_vol:benign_prostatic_hyperplasia -0.0078307  0.0054541  -1.436  0.15462
##                                            
## (Intercept)                             ***
## cancer_vol                              ***
## benign_prostatic_hyperplasia            *  
## seminal_vesicle_invasion1               *  
## gleason_score7                             
## gleason_score8                          ** 
## I(cancer_vol^2)                         *  
## I(benign_prostatic_hyperplasia^2)          
## cancer_vol:benign_prostatic_hyperplasia    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7493 on 88 degrees of freedom
## Multiple R-squared:  0.6133, Adjusted R-squared:  0.5782 
## F-statistic: 17.45 on 8 and 88 DF,  p-value: 2.714e-15</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;olivedrab1&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3a, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;goldenrod&quot;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3aa, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3b, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;coral&quot;</span>)</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit4, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;orchid&quot;</span>)</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-16-2.png" width="768" /></p>
</div>
</div>
<div id="part-iii-model-building-and-model-selection" class="section level2">
<h2>Part III: Model building and model selection</h2>
<ul>
<li><p>Split the data into 2: training and validation data</p></li>
<li><p>Draw side-by-side boxplots for PSA and other variables, in training data and validation data, respectively to see if they have similar distributions in these two sets.</p></li>
<li><p>Apply box-cox procedure on first-order effects of all predictors (Model 1) and determine if it appears that any (further) transformation of the response variable is still needed</p></li>
<li><p>Apply the forward stepwise procedure using R function stepAIC(), starting from the null-model and using the AICp criterion.</p></li>
<li><p>Determine if the best model produced by prior step matches with the best model determined using AICp in the best subsets selection method.</p></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">###split data into two halves (training and validation)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(prostate)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>n), n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>prostate.t <span class="ot">&lt;-</span> prostate[ind, ] <span class="co">#training set</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>prostate.v <span class="ot">&lt;-</span> prostate[<span class="sc">-</span>ind, ] <span class="co">#validation/test set</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col_name <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&#39;psa_level&#39;</span>, <span class="st">&#39;cancer_vol&#39;</span>, <span class="st">&#39;weight&#39;</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;age&#39;</span>, <span class="st">&#39;benign_prostatic_hyperplasia&#39;</span>, <span class="st">&#39;capsular_penetration&#39;</span>)){</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(prostate.t[, col_name],prostate.v[, col_name],<span class="at">main=</span>col_name,<span class="at">names=</span><span class="fu">c</span>(<span class="st">&#39;training&#39;</span>,<span class="st">&#39;validation&#39;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;coral&quot;</span>,<span class="st">&quot;lightblue&quot;</span>))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-17-1.png" width="768" /></p>
<ul>
<li>The training data and validation data appear to have similar distribution.</li>
</ul>
<div id="i.-best-subsets-regression" class="section level4">
<h4>I. Best Subsets Regression</h4>
<ul>
<li><p>Perform best subsets selection using the R function regsubsets() from the leaps library with Model 1 as the full model</p></li>
<li><p>Identify the best model according to each criterion: <span class="math inline">\(SSE_p\)</span>,<span class="math inline">\(R^2_p\)</span>, <span class="math inline">\(R^2_{a,p}\)</span>, <span class="math inline">\(C_p\)</span>, <span class="math inline">\(AIC_p\)</span>,<span class="math inline">\(BIC_p\)</span></p></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fit5<span class="ot">&lt;-</span><span class="fu">lm</span>(psa_level<span class="sc">~</span>.,<span class="at">data=</span>prostate.t)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ ., data = prostate.t)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.39781 -0.42545 -0.02081  0.43310  1.45613 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                   4.321e-01  1.229e+00   0.352  0.72698   
## cancer_vol                    4.602e-02  2.417e-02   1.904  0.06436 . 
## weight                        2.396e-05  1.694e-03   0.014  0.98879   
## age                           1.810e-02  1.956e-02   0.926  0.36033   
## benign_prostatic_hyperplasia  7.640e-02  4.039e-02   1.892  0.06596 . 
## seminal_vesicle_invasion1     1.011e+00  3.109e-01   3.251  0.00237 **
## capsular_penetration         -4.094e-02  4.545e-02  -0.901  0.37330   
## gleason_score7                2.291e-01  2.457e-01   0.933  0.35672   
## gleason_score8                7.121e-01  3.068e-01   2.321  0.02561 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6727 on 39 degrees of freedom
## Multiple R-squared:  0.6087, Adjusted R-squared:  0.5284 
## F-statistic: 7.584 on 8 and 39 DF,  p-value: 4.642e-06</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(fit5<span class="sc">$</span>coef) <span class="co">#8 regression coefficients</span></span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit5)[<span class="st">&#39;Residuals&#39;</span>,<span class="dv">3</span>] <span class="co">#MSE</span></span></code></pre></div>
<pre><code>## [1] 0.4525879</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit5,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(fit5)</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>sub_set<span class="ot">&lt;-</span><span class="fu">regsubsets</span>(psa_level<span class="sc">~</span>.,<span class="at">data=</span>prostate.t,<span class="at">nbest=</span><span class="dv">3</span>,<span class="at">nvmax=</span><span class="dv">8</span>,<span class="at">method=</span><span class="st">&quot;exhaustive&quot;</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>(sum_sub<span class="ot">&lt;-</span><span class="fu">summary</span>(sub_set))</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(psa_level ~ ., data = prostate.t, nbest = 3, 
##     nvmax = 8, method = &quot;exhaustive&quot;)
## 8 Variables  (and intercept)
##                              Forced in Forced out
## cancer_vol                       FALSE      FALSE
## weight                           FALSE      FALSE
## age                              FALSE      FALSE
## benign_prostatic_hyperplasia     FALSE      FALSE
## seminal_vesicle_invasion1        FALSE      FALSE
## capsular_penetration             FALSE      FALSE
## gleason_score7                   FALSE      FALSE
## gleason_score8                   FALSE      FALSE
## 3 subsets of each size up to 8
## Selection Algorithm: exhaustive
##          cancer_vol weight age benign_prostatic_hyperplasia
## 1  ( 1 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot; &quot;                         
## 1  ( 2 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot; &quot;                         
## 1  ( 3 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot; &quot;                         
## 2  ( 1 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot; &quot;                         
## 2  ( 2 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot; &quot;                         
## 2  ( 3 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 3  ( 1 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 3  ( 2 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 3  ( 3 ) &quot; &quot;        &quot; &quot;    &quot;*&quot; &quot; &quot;                         
## 4  ( 1 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 4  ( 2 ) &quot; &quot;        &quot; &quot;    &quot;*&quot; &quot;*&quot;                         
## 4  ( 3 ) &quot; &quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 5  ( 1 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 5  ( 2 ) &quot;*&quot;        &quot; &quot;    &quot;*&quot; &quot;*&quot;                         
## 5  ( 3 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 6  ( 1 ) &quot;*&quot;        &quot; &quot;    &quot;*&quot; &quot;*&quot;                         
## 6  ( 2 ) &quot;*&quot;        &quot; &quot;    &quot; &quot; &quot;*&quot;                         
## 6  ( 3 ) &quot;*&quot;        &quot; &quot;    &quot;*&quot; &quot;*&quot;                         
## 7  ( 1 ) &quot;*&quot;        &quot; &quot;    &quot;*&quot; &quot;*&quot;                         
## 7  ( 2 ) &quot;*&quot;        &quot;*&quot;    &quot;*&quot; &quot;*&quot;                         
## 7  ( 3 ) &quot;*&quot;        &quot;*&quot;    &quot; &quot; &quot;*&quot;                         
## 8  ( 1 ) &quot;*&quot;        &quot;*&quot;    &quot;*&quot; &quot;*&quot;                         
##          seminal_vesicle_invasion1 capsular_penetration gleason_score7
## 1  ( 1 ) &quot; &quot;                       &quot; &quot;                  &quot; &quot;           
## 1  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 1  ( 3 ) &quot; &quot;                       &quot; &quot;                  &quot; &quot;           
## 2  ( 1 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 2  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 2  ( 3 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 3  ( 1 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 3  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 3  ( 3 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 4  ( 1 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 4  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 4  ( 3 ) &quot;*&quot;                       &quot; &quot;                  &quot;*&quot;           
## 5  ( 1 ) &quot;*&quot;                       &quot; &quot;                  &quot;*&quot;           
## 5  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot; &quot;           
## 5  ( 3 ) &quot;*&quot;                       &quot;*&quot;                  &quot; &quot;           
## 6  ( 1 ) &quot;*&quot;                       &quot; &quot;                  &quot;*&quot;           
## 6  ( 2 ) &quot;*&quot;                       &quot;*&quot;                  &quot;*&quot;           
## 6  ( 3 ) &quot;*&quot;                       &quot;*&quot;                  &quot; &quot;           
## 7  ( 1 ) &quot;*&quot;                       &quot;*&quot;                  &quot;*&quot;           
## 7  ( 2 ) &quot;*&quot;                       &quot; &quot;                  &quot;*&quot;           
## 7  ( 3 ) &quot;*&quot;                       &quot;*&quot;                  &quot;*&quot;           
## 8  ( 1 ) &quot;*&quot;                       &quot;*&quot;                  &quot;*&quot;           
##          gleason_score8
## 1  ( 1 ) &quot; &quot;           
## 1  ( 2 ) &quot; &quot;           
## 1  ( 3 ) &quot;*&quot;           
## 2  ( 1 ) &quot;*&quot;           
## 2  ( 2 ) &quot; &quot;           
## 2  ( 3 ) &quot; &quot;           
## 3  ( 1 ) &quot;*&quot;           
## 3  ( 2 ) &quot; &quot;           
## 3  ( 3 ) &quot;*&quot;           
## 4  ( 1 ) &quot;*&quot;           
## 4  ( 2 ) &quot;*&quot;           
## 4  ( 3 ) &quot;*&quot;           
## 5  ( 1 ) &quot;*&quot;           
## 5  ( 2 ) &quot;*&quot;           
## 5  ( 3 ) &quot;*&quot;           
## 6  ( 1 ) &quot;*&quot;           
## 6  ( 2 ) &quot;*&quot;           
## 6  ( 3 ) &quot;*&quot;           
## 7  ( 1 ) &quot;*&quot;           
## 7  ( 2 ) &quot;*&quot;           
## 7  ( 3 ) &quot;*&quot;           
## 8  ( 1 ) &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">nrow</span>(prostate.t)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="do">## number of coefficients in each model: p</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>p.m<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">as.numeric</span>(<span class="fu">rownames</span>(sum_sub<span class="sc">$</span>which))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>sse<span class="ot">&lt;-</span>sum_sub<span class="sc">$</span>rss</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>aic<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(sse<span class="sc">/</span>n)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>p.m</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>bic<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(sse<span class="sc">/</span>n)<span class="sc">+</span><span class="fu">log</span>(n)<span class="sc">*</span>p.m</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>res_sub<span class="ot">&lt;-</span><span class="fu">cbind</span>(sum_sub<span class="sc">$</span>which,sse,sum_sub<span class="sc">$</span>rsq,sum_sub<span class="sc">$</span>adjr2,sum_sub<span class="sc">$</span>cp, aic, bic)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">lm</span>(psa_level<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>prostate.t) <span class="do">##fit the model with only intercept</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level <span class="sc">~</span>., <span class="at">data =</span> prostate.t)  <span class="co">#full first-order model</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>prostate.t) <span class="do">##full first-order model with interactions </span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>sse1<span class="ot">&lt;-</span><span class="fu">sum</span>(fit<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>c1<span class="ot">&lt;-</span>sse1<span class="sc">/</span><span class="fu">summary</span>(full)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (n <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> p)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>aic1<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(sse1<span class="sc">/</span>n)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>p</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>bic1<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(sse1<span class="sc">/</span>n)<span class="sc">+</span><span class="fu">log</span>(n)<span class="sc">*</span>p</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>none<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),sse1,<span class="dv">0</span>,<span class="dv">0</span>,c1,bic1,aic1)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>res_sub<span class="ot">&lt;-</span><span class="fu">rbind</span>(none,res_sub) <span class="do">##combine the results with other models</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res_sub)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">colnames</span>(sum_sub<span class="sc">$</span>which),<span class="st">&quot;sse&quot;</span>, <span class="st">&quot;R^2&quot;</span>, <span class="st">&quot;R^2_a&quot;</span>, <span class="st">&quot;Cp&quot;</span>, <span class="st">&quot;aic&quot;</span>, <span class="st">&quot;bic&quot;</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>res_sub</span></code></pre></div>
<pre><code>##      (Intercept) cancer_vol weight age benign_prostatic_hyperplasia
## none           1          0      0   0                            0
## 1              1          1      0   0                            0
## 1              1          0      0   0                            0
## 1              1          0      0   0                            0
## 2              1          0      0   0                            0
## 2              1          1      0   0                            0
## 2              1          0      0   0                            1
## 3              1          0      0   0                            1
## 3              1          1      0   0                            1
## 3              1          0      0   1                            0
## 4              1          1      0   0                            1
## 4              1          0      0   1                            1
## 4              1          0      0   0                            1
## 5              1          1      0   0                            1
## 5              1          1      0   1                            1
## 5              1          1      0   0                            1
## 6              1          1      0   1                            1
## 6              1          1      0   0                            1
## 6              1          1      0   1                            1
## 7              1          1      0   1                            1
## 7              1          1      1   1                            1
## 7              1          1      1   0                            1
## 8              1          1      1   1                            1
##      seminal_vesicle_invasion1 capsular_penetration gleason_score7
## none                         0                    0              0
## 1                            0                    0              0
## 1                            1                    0              0
## 1                            0                    0              0
## 2                            1                    0              0
## 2                            1                    0              0
## 2                            1                    0              0
## 3                            1                    0              0
## 3                            1                    0              0
## 3                            1                    0              0
## 4                            1                    0              0
## 4                            1                    0              0
## 4                            1                    0              1
## 5                            1                    0              1
## 5                            1                    0              0
## 5                            1                    1              0
## 6                            1                    0              1
## 6                            1                    1              1
## 6                            1                    1              0
## 7                            1                    1              1
## 7                            1                    0              1
## 7                            1                    1              1
## 8                            1                    1              1
##      gleason_score8      sse       R^2     R^2_a        Cp         aic
## none              0 45.10856 0.0000000 0.0000000 53.668051   0.8890059
## 1                 0 28.50702 0.3680352 0.3542968 18.986704 -21.0104279
## 1                 0 30.61089 0.3213949 0.3066427 23.635243 -17.5925620
## 1                 1 34.90068 0.2262957 0.2094760 33.113600 -11.2973397
## 2                 1 24.26454 0.4620857 0.4381784 11.612865 -26.7448887
## 2                 0 25.18281 0.4417288 0.4169167 13.641802 -24.9618948
## 2                 0 25.96976 0.4242832 0.3986957 15.380576 -23.4848831
## 3                 1 20.21460 0.5518677 0.5213132  4.664474 -33.5101997
## 3                 0 21.01723 0.5340744 0.5023067  6.437896 -31.6412022
## 3                 1 21.55065 0.5222493 0.4896754  7.616483 -30.4381718
## 4                 1 18.88099 0.5814321 0.5424956  3.717845 -34.7861729
## 4                 1 19.61030 0.5652642 0.5248236  5.329271 -32.9669997
## 4                 1 19.87350 0.5594294 0.5184461  5.910815 -32.3270522
## 5                 1 18.35819 0.5930221 0.5445723  4.562699 -34.1340165
## 5                 1 18.47101 0.5905208 0.5417733  4.811991 -33.8399187
## 5                 1 18.51809 0.5894773 0.5406056  4.915995 -33.7177528
## 6                 1 18.02045 0.6005092 0.5420472  5.816467 -33.0252958
## 6                 1 18.03874 0.6001039 0.5415825  5.856864 -32.9766208
## 6                 1 18.05368 0.5997727 0.5412028  5.889876 -32.9368807
## 7                 1 17.65102 0.6086991 0.5402214  7.000200 -32.0195582
## 7                 1 18.01806 0.6005622 0.5306606  7.811184 -31.0316658
## 7                 1 18.03870 0.6001047 0.5301230  7.856788 -30.9767124
## 8                 1 17.65093 0.6087011 0.5284346  9.000000 -30.0198044
##              bic
## none  -0.9821951
## 1    -17.2680258
## 1    -13.8501600
## 1     -7.5549377
## 2    -21.1312857
## 2    -19.3482918
## 2    -17.8712800
## 3    -26.0253956
## 3    -24.1563981
## 3    -22.9533678
## 4    -25.4301678
## 4    -23.6109947
## 4    -22.9710472
## 5    -22.9068105
## 5    -22.6127127
## 5    -22.4905467
## 6    -19.9268888
## 6    -19.8782137
## 6    -19.8384737
## 7    -17.0499501
## 7    -16.0620577
## 7    -16.0071043
## 8    -13.1789953</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">##The best model according to each criterion are extracted as follows: </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#result.sum = summary(sub_set)</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#(criteria = data.frame(Nvar = 1:7, R2adj=result.sum$adjr2, CP=result.sum$cp, BIC=result.sum$bic))</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Estimated best subset byeach criterion</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#(which.best.subset = data.frame(R2adj=which.max(result.sum$adjr2), CP=which.min(result.sum$cp), BIC=which.min(result.sum$bic)))</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>(PRESS_none <span class="ot">&lt;-</span> <span class="fu">sum</span>((fit<span class="sc">$</span>residuals<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">influence</span>(fit)<span class="sc">$</span>hat))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 47.04849</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(PRESS_full <span class="ot">&lt;-</span> <span class="fu">sum</span>((full<span class="sc">$</span>residuals<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">influence</span>(full)<span class="sc">$</span>hat))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 26.62755</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot results</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>p.plot <span class="ot">&lt;-</span> res_sub[, <span class="dv">1</span>] <span class="sc">+</span> res_sub[, <span class="dv">2</span>] <span class="sc">+</span> res_sub[, <span class="dv">3</span>] <span class="sc">+</span> res_sub[, <span class="dv">4</span>] <span class="sc">+</span> res_sub[, <span class="dv">5</span>]<span class="sc">+</span> res_sub[, <span class="dv">6</span>]<span class="sc">+</span> res_sub[, <span class="dv">7</span>]<span class="sc">+</span> res_sub[, <span class="dv">8</span>]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>res.sub.plot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(p.plot, res_sub))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>best.plot <span class="ot">&lt;-</span> res.sub.plot[<span class="fu">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.sub.plot<span class="sc">$</span>p.plot, res.sub.plot<span class="sc">$</span><span class="st">`</span><span class="at">R^2</span><span class="st">`</span>, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R^2&quot;</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span><span class="st">`</span><span class="at">R^2</span><span class="st">`</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.sub.plot<span class="sc">$</span>p.plot, res.sub.plot<span class="sc">$</span><span class="st">`</span><span class="at">R^2_a</span><span class="st">`</span>, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R^2_a&quot;</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span><span class="st">`</span><span class="at">R^2_a</span><span class="st">`</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.sub.plot<span class="sc">$</span>p.plot, res.sub.plot<span class="sc">$</span>Cp, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cp&quot;</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span>Cp, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span>p.plot, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.sub.plot<span class="sc">$</span>p.plot, res.sub.plot<span class="sc">$</span>aic, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;aic&quot;</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span>aic, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.sub.plot<span class="sc">$</span>p.plot, res.sub.plot<span class="sc">$</span>bic, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;bic&quot;</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(best.plot<span class="sc">$</span>p.plot, best.plot<span class="sc">$</span>bic, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-18-2.png" width="768" /></p>
<p><strong>Observations:</strong></p>
<ul>
<li>Best subsets selection</li>
<li>Best model according to <span class="math inline">\(SSEp\)</span>: Model 8</li>
<li>Best model according to <span class="math inline">\(R^2\)</span>: Model 8</li>
<li>Best model according to <span class="math inline">\(R^2_{a}\)</span>: Model 5 ( cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion1 + gleason_score7 + gleason_score8)</li>
<li>Best model according to <span class="math inline">\(C_p\)</span>, <span class="math inline">\(AIC_p\)</span>, <span class="math inline">\(BIC_p\)</span>: Model 4 (cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion1 + gleason_score8) _ The box-cox log-likelihood does not suggest any power transformation since lambda~1</li>
</ul>
</div>
<div id="ii-stepwise-procedures" class="section level4">
<h4>II: Stepwise Procedures</h4>
<ul>
<li><p>Perform best subsets selection using the R function regsubsets() from the leaps library</p></li>
<li><p>Identify the best model according to <span class="math inline">\(AIC_p\)</span> and <span class="math inline">\(BIC_p\)</span></p></li>
<li><p>Apply the forward stepwise procedure using R function stepAIC(), starting from the null-model and using the AICp criterion.</p></li>
<li><p>Determine if the best model produced by prior step matches with the best model determined using AICp in the best subsets selection method.</p></li>
<li><p>Draw residual vs. fitted value plot and the residual Q-Q plot of this model and determine if the model appears to be adequate.</p></li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:formattable&#39;:
## 
##     area</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">nrow</span>(prostate.t)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">## forward selection based on AIC:</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>(step.f<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>step.f<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev        AIC
## 1                                                    47   45.10856   1.017805
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.010428
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -18.961895
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -23.641202</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(step.fa<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>step.fa<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev        AIC
## 1                                                    47   45.10856   1.017805
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.010428
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -18.961895
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -23.641202</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## backward elimination based on AIC</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>(step.b <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>step.b<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -12.01980
## 2               - weight  1 9.055792e-05        40   17.65102 -16.01956
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.02530
## 4                  - age  1 3.377354e-01        42   18.35819 -22.13402
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -23.64120</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(step.ba <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>step.ba<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -12.01980
## 2               - weight  1 9.055792e-05        40   17.65102 -16.01956
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.02530
## 4                  - age  1 3.377354e-01        42   18.35819 -22.13402
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -23.64120</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## forward stepwise based on AIC</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>(step.fs<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>step.fs<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev        AIC
## 1                                                    47   45.10856   1.017805
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.010428
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -18.961895
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -23.641202</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>(step.fsa<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>step.fsa<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev        AIC
## 1                                                    47   45.10856   1.017805
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.010428
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -18.961895
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -23.641202</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## backward stepwise based on AIC</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>(step.bs<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>step.bs<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -12.01980
## 2               - weight  1 9.055792e-05        40   17.65102 -16.01956
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.02530
## 4                  - age  1 3.377354e-01        42   18.35819 -22.13402
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -23.64120</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(step.bsa<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>step.bsa<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -12.01980
## 2               - weight  1 9.055792e-05        40   17.65102 -16.01956
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.02530
## 4                  - age  1 3.377354e-01        42   18.35819 -22.13402
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -23.64120</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## selection based on BIC: set option &#39;k=log(n)&#39;</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>(step.f1<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>step.f1<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev         AIC
## 1                                                    47   45.10856   0.8890059
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.2680258
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -19.3482918
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -24.1563981</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(step.f1a<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>step.f1a<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev         AIC
## 1                                                    47   45.10856   0.8890059
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.2680258
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -19.3482918
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -24.1563981</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(step.b1 <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>step.b1<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -13.17900
## 2               - weight  1 9.055792e-05        40   17.65102 -17.04995
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.92689
## 4                  - age  1 3.377354e-01        42   18.35819 -22.90681
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -24.15640</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>(step.b1a <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>step.b1a<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -13.17900
## 2               - weight  1 9.055792e-05        40   17.65102 -17.04995
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.92689
## 4                  - age  1 3.377354e-01        42   18.35819 -22.90681
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -24.15640</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>(step.fs1<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>step.fs1<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev         AIC
## 1                                                    47   45.10856   0.8890059
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.2680258
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -19.3482918
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -24.1563981</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>(step.fs2<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(fit, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
##    seminal_vesicle_invasion1  benign_prostatic_hyperplasia  
##                      0.90993                       0.10150</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>step.fs2<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ 1
## 
## Final Model:
## psa_level ~ cancer_vol + seminal_vesicle_invasion + benign_prostatic_hyperplasia
## 
## 
##                             Step Df  Deviance Resid. Df Resid. Dev         AIC
## 1                                                    47   45.10856   0.8890059
## 2                   + cancer_vol  1 16.601535        46   28.50702 -17.2680258
## 3     + seminal_vesicle_invasion  1  3.324214        45   25.18281 -19.3482918
## 4 + benign_prostatic_hyperplasia  1  4.165577        44   21.01723 -24.1563981</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>(step.bs1<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full1, <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate.t)
## 
## Coefficients:
##                  (Intercept)                    cancer_vol  
##                      1.69605                       0.05786  
## benign_prostatic_hyperplasia     seminal_vesicle_invasion1  
##                      0.10150                       0.90993</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>step.bs1<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## psa_level ~ cancer_vol + weight + age + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + capsular_penetration + gleason_score
## 
## Final Model:
## psa_level ~ cancer_vol + benign_prostatic_hyperplasia + seminal_vesicle_invasion
## 
## 
##                     Step Df     Deviance Resid. Df Resid. Dev       AIC
## 1                                               39   17.65093 -13.17900
## 2               - weight  1 9.055792e-05        40   17.65102 -17.04995
## 3 - capsular_penetration  1 3.694326e-01        41   18.02045 -19.92689
## 4                  - age  1 3.377354e-01        42   18.35819 -22.90681
## 5        - gleason_score  2 2.659044e+00        44   21.01723 -24.15640</code></pre>
<ul>
<li>The “best” model according to all stepwise procedures include predictors: cancer_vol, seminal_vesicle_invasion, and benign_prostatic_hyperplasia</li>
</ul>
</div>
<div id="part-iv-model-validation" class="section level3">
<h3>Part IV: Model validation</h3>
<ul>
<li><p>Internal validation of model</p></li>
<li><p>External validation using the validation set</p></li>
<li><p>Choose the “final model” based on the internal and external model validation results</p></li>
<li><p>Fit the “final model” using the entire data set (training and validation data set combined)</p></li>
</ul>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">###use best model according to stepwise procedures </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>train1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level <span class="sc">~</span> cancer_vol  <span class="sc">+</span> benign_prostatic_hyperplasia  <span class="sc">+</span> seminal_vesicle_invasion , <span class="at">data =</span> prostate.t)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># re-run model using validation data</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>valid1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level <span class="sc">~</span> cancer_vol  <span class="sc">+</span> benign_prostatic_hyperplasia  <span class="sc">+</span> seminal_vesicle_invasion, <span class="at">data =</span> prostate.v)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>mod_sum <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(train1))[, <span class="dv">1</span>], <span class="fu">coef</span>(<span class="fu">summary</span>(valid1))[, <span class="dv">1</span>], <span class="fu">coef</span>(<span class="fu">summary</span>(train1))[, </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>], <span class="fu">coef</span>(<span class="fu">summary</span>(valid1))[, <span class="dv">2</span>])</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mod_sum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Train Est&quot;</span>, <span class="st">&quot;Valid Est&quot;</span>, <span class="st">&quot;Train s.e.&quot;</span>, <span class="st">&quot;Valid s.e.&quot;</span>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>mod_sum</span></code></pre></div>
<pre><code>##                               Train Est  Valid Est Train s.e. Valid s.e.
## (Intercept)                  1.69604835 1.38587311 0.17802214 0.20198456
## cancer_vol                   0.05785642 0.08685467 0.01796800 0.01884337
## benign_prostatic_hyperplasia 0.10149702 0.10406554 0.03436981 0.04286352
## seminal_vesicle_invasion1    0.90992732 0.71425373 0.27981314 0.44023801</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">##examine the SSE and adjusted R squares using both the training data and validation data</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>sse_t <span class="ot">&lt;-</span> <span class="fu">sum</span>(train1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>sse_v <span class="ot">&lt;-</span> <span class="fu">sum</span>(valid1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>Radj_t <span class="ot">&lt;-</span> <span class="fu">summary</span>(train1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>Radj_v <span class="ot">&lt;-</span> <span class="fu">summary</span>(valid1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>train_sum <span class="ot">&lt;-</span> <span class="fu">c</span>(sse_t,Radj_t)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>valid_sum <span class="ot">&lt;-</span> <span class="fu">c</span>(sse_v,Radj_v)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>criteria <span class="ot">&lt;-</span> <span class="fu">rbind</span>(train_sum,valid_sum)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(criteria) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SSE&quot;</span>,<span class="st">&quot;R2_adj&quot;</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>criteria</span></code></pre></div>
<pre><code>##                SSE    R2_adj
## train_sum 21.01723 0.5023067
## valid_sum 35.18765 0.5333025</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get MSPE_v from new data</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> prostate.v[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>newdata<span class="sc">$</span>seminal_vesicle_invasion<span class="ot">&lt;-</span><span class="fu">as.factor</span>(newdata<span class="sc">$</span>seminal_vesicle_invasion)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(newdata, class)</span></code></pre></div>
<pre><code>##                   cancer_vol                       weight 
##                    &quot;numeric&quot;                    &quot;numeric&quot; 
##                          age benign_prostatic_hyperplasia 
##                    &quot;integer&quot;                    &quot;numeric&quot; 
##     seminal_vesicle_invasion         capsular_penetration 
##                     &quot;factor&quot;                    &quot;numeric&quot; 
##                gleason_score 
##                     &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(prostate)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>y.hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(train1, newdata)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>(MSPE <span class="ot">&lt;-</span> <span class="fu">mean</span>((prostate.v<span class="sc">$</span>psa_level <span class="sc">-</span> y.hat)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.7873197</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>sse_t<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.433345</code></pre>
<ul>
<li>Most of the estimated coefficients as well as their standard errors agree quite closely on the training and validation data sets</li>
<li>The SSE and adjusted R squares values are close</li>
<li>Since <span class="math inline">\(MSPE_v\)</span> is somewhat close to <span class="math inline">\(SSE/n\)</span>, then there is no severe overfitting in the model.</li>
</ul>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Internal validation  - 1</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">names</span>(step.fs1<span class="sc">$</span>coefficients)[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] &quot;cancer_vol&quot;                   &quot;seminal_vesicle_invasion1&quot;   
## [3] &quot;benign_prostatic_hyperplasia&quot;</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>modelfs1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span>cancer_vol<span class="sc">+</span> benign_prostatic_hyperplasia  <span class="sc">+</span> seminal_vesicle_invasion , <span class="at">data =</span> prostate.t)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>drops2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;weight&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;capsular_penetration&quot;</span>, <span class="st">&quot;gleason-score&quot;</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>data.tt<span class="ot">=</span>prostate.t[,<span class="sc">!</span>(<span class="fu">names</span>(prostate)<span class="sc">%in%</span>drops2)]</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co">#data.tt&lt;-prostate.t[ c(&quot;psa_level&quot;,&quot;cancer_vol&quot; , &quot;benign_prostatic_hyperplasia&quot;, &quot;seminal_vesicle_invasion1&quot;),  ]</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>fit5<span class="ot">&lt;-</span> <span class="fu">lm</span> (psa_level<span class="sc">~</span>., <span class="at">data =</span> data.tt)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(fit5<span class="sc">$</span>coef) <span class="co">#number of coefficents in Model</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>mse5<span class="ot">&lt;-</span><span class="fu">anova</span>(fit5)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">3</span>]</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>mse5<span class="co">#MSE for Model</span></span></code></pre></div>
<pre><code>## [1] 0.4370997</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>sse.fs1<span class="ot">&lt;-</span><span class="fu">anova</span>(step.fs1)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">2</span>] <span class="co">#first order selected</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>sse.fs1</span></code></pre></div>
<pre><code>## [1] 21.01723</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>mse.fs1<span class="ot">&lt;-</span><span class="fu">anova</span>(step.fs1)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">3</span>] <span class="co">#MSE for Model fs1</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>mse.fs1</span></code></pre></div>
<pre><code>## [1] 0.4776643</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>p.fs1<span class="ot">&lt;-</span><span class="fu">length</span>(step.fs1<span class="sc">$</span>coefficients) <span class="co">#4</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>p.fs1</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>cp.fs1<span class="ot">&lt;-</span>sse.fs1<span class="sc">/</span>mse5<span class="sc">-</span>(n<span class="dv">-2</span><span class="sc">*</span>p.fs1) <span class="co">#C_p for Model fs1</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>cp.fs1</span></code></pre></div>
<pre><code>## [1] 7.58338</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>press.fs1<span class="ot">&lt;-</span><span class="fu">sum</span>(step.fs1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">influence</span>(step.fs1)<span class="sc">$</span>hat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>press.fs1</span></code></pre></div>
<pre><code>## [1] 24.58292</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Internal validation -2</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="do">###using best model according to best subset procedures based on criterion </span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span>cancer_vol<span class="sc">+</span> benign_prostatic_hyperplasia  <span class="sc">+</span> seminal_vesicle_invasion <span class="sc">+</span> gleason_score, <span class="at">data =</span> prostate.t)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>drops2a<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;weight&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;capsular_penetration&quot;</span>)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>data.tt2<span class="ot">=</span>prostate.t[,<span class="sc">!</span>(<span class="fu">names</span>(prostate)<span class="sc">%in%</span>drops2a)]</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co">#data.tt&lt;-prostate.t[ c(&quot;psa_level&quot;,&quot;cancer_vol&quot; , &quot;benign_prostatic_hyperplasia&quot;, &quot;seminal_vesicle_invasion1&quot;),  ]</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>fit6<span class="ot">&lt;-</span> <span class="fu">lm</span> (psa_level<span class="sc">~</span>., <span class="at">data =</span> data.tt2)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(fit6<span class="sc">$</span>coef) <span class="co">#number of coefficents in Model</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>(mse6<span class="ot">&lt;-</span><span class="fu">anova</span>(fit6)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">3</span>])<span class="co">#MSE for Model</span></span></code></pre></div>
<pre><code>## [1] 0.4370997</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>(sse.fs2<span class="ot">&lt;-</span><span class="fu">anova</span>(model2)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">2</span>]) <span class="co">#first order selected</span></span></code></pre></div>
<pre><code>## [1] 18.35819</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>(mse.fs2<span class="ot">&lt;-</span><span class="fu">anova</span>(model2)[<span class="st">&quot;Residuals&quot;</span>,<span class="dv">3</span>]) <span class="co">#MSE for Model2</span></span></code></pre></div>
<pre><code>## [1] 0.4370997</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>(p.fs2<span class="ot">&lt;-</span><span class="fu">length</span>(model2<span class="sc">$</span>coefficients)) <span class="co">#5</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>(cp.fs2<span class="ot">&lt;-</span>sse.fs2<span class="sc">/</span>mse6<span class="sc">-</span>(n<span class="dv">-2</span><span class="sc">*</span>p.fs2)) <span class="co">#C_p for Model 2</span></span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>(press.fs2<span class="ot">&lt;-</span><span class="fu">sum</span>(model2<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">influence</span>(model2)<span class="sc">$</span>hat)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 23.25294</code></pre>
<ul>
<li>For both models, <span class="math inline">\(Cp ≈p\)</span> and <span class="math inline">\(Press_p\)</span> and <span class="math inline">\(SSE_p\)</span> are somewhat close, which supports their validity: little bias and not much overfitting.</li>
</ul>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="do">##External  validation - 1 </span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>fit.fs1.v<span class="ot">&lt;-</span><span class="fu">lm</span>(step.fs1,<span class="at">data=</span>prostate.v) <span class="co">#Model fs1 on validation data</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step.fs1) <span class="co">#summary on training data</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + seminal_vesicle_invasion + 
##     benign_prostatic_hyperplasia, data = prostate.t)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.62251 -0.48856 -0.01258  0.43652  1.39462 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.69605    0.17802   9.527 2.91e-12 ***
## cancer_vol                    0.05786    0.01797   3.220  0.00241 ** 
## seminal_vesicle_invasion1     0.90993    0.27981   3.252  0.00220 ** 
## benign_prostatic_hyperplasia  0.10150    0.03437   2.953  0.00503 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6911 on 44 degrees of freedom
## Multiple R-squared:  0.5341, Adjusted R-squared:  0.5023 
## F-statistic: 16.81 on 3 and 44 DF,  p-value: 2.022e-07</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.fs1.v) <span class="co">#summary on validation data</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = step.fs1, data = prostate.v)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.8638 -0.5089  0.1578  0.5782  1.5188 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.38587    0.20198   6.861 1.64e-08 ***
## cancer_vol                    0.08685    0.01884   4.609 3.34e-05 ***
## seminal_vesicle_invasion1     0.71425    0.44024   1.622   0.1117    
## benign_prostatic_hyperplasia  0.10407    0.04286   2.428   0.0193 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8843 on 45 degrees of freedom
## Multiple R-squared:  0.5625, Adjusted R-squared:  0.5333 
## F-statistic: 19.28 on 3 and 45 DF,  p-value: 3.471e-08</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percent change in parameter estimation</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(step.fs1)<span class="sc">-</span><span class="fu">coef</span>(fit.fs1.v))<span class="sc">/</span><span class="fu">abs</span>(<span class="fu">coef</span>(step.fs1))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                  (Intercept)                   cancer_vol 
##                       18.288                       50.121 
##    seminal_vesicle_invasion1 benign_prostatic_hyperplasia 
##                       21.504                        2.531</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>sd.fs1<span class="ot">&lt;-</span> <span class="fu">summary</span>(step.fs1)<span class="sc">$</span>coefficients[,<span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>sd.fs1.v<span class="ot">&lt;-</span> <span class="fu">summary</span>(fit.fs1.v)<span class="sc">$</span>coefficients[,<span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co">#percent change in standard errors</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">abs</span>(sd.fs1<span class="sc">-</span>sd.fs1.v)<span class="sc">/</span>sd.fs1<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                  (Intercept)                   cancer_vol 
##                       13.460                        4.872 
##    seminal_vesicle_invasion1 benign_prostatic_hyperplasia 
##                       57.333                       24.713</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">##mean squared prediction error</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>pred.fs1<span class="ot">&lt;-</span><span class="fu">predict.lm</span>(step.fs1, prostate.v[,<span class="sc">-</span><span class="dv">3</span>])</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>pred.fs1</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6       10       12 
## 1.728442 1.717548 1.730791 1.713475 1.818530 1.716292 1.768143 2.072465 
##       16       17       18       19       20       21       22       23 
## 1.965925 2.084793 2.267375 1.729096 2.299117 1.878770 2.591421 1.775364 
##       31       35       36       37       38       40       43       44 
## 2.493925 1.753326 2.799417 1.992234 1.787699 2.084640 2.360557 2.035718 
##       45       46       47       48       49       52       53       56 
## 2.536838 2.189005 4.158243 2.441782 2.028989 2.804676 2.242749 2.747651 
##       57       58       61       62       63       64       66       67 
## 1.848668 2.207602 2.830875 3.546357 2.628636 3.804003 2.325122 2.734055 
##       69       82       85       90       91       93       94       95 
## 1.732938 2.565560 2.526960 3.141135 3.188183 3.586382 5.244471 3.668034 
##       97 
## 4.622884</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>mspe.fs1<span class="ot">&lt;-</span><span class="fu">mean</span>((pred.fs1<span class="sc">-</span>prostate.v[,<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>mspe.fs1</span></code></pre></div>
<pre><code>## [1] 1698.921</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>press.fs1<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.5068644</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>mse.fs1</span></code></pre></div>
<pre><code>## [1] 0.4776643</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="do">##External  validation - 2 </span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>fit.fs2.v<span class="ot">&lt;-</span><span class="fu">lm</span>(model2,<span class="at">data=</span>prostate.v) <span class="co">#Model2 on validation data</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2) <span class="co">#summary on training data</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion + gleason_score, data = prostate.t)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.43793 -0.46912 -0.04104  0.43159  1.37643 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.55126    0.22390   6.928 1.84e-08 ***
## cancer_vol                    0.03759    0.02019   1.862  0.06962 .  
## benign_prostatic_hyperplasia  0.09697    0.03294   2.944  0.00526 ** 
## seminal_vesicle_invasion1     0.91864    0.27903   3.292  0.00202 ** 
## gleason_score7                0.25904    0.23686   1.094  0.28034    
## gleason_score8                0.73913    0.30001   2.464  0.01793 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6611 on 42 degrees of freedom
## Multiple R-squared:  0.593,  Adjusted R-squared:  0.5446 
## F-statistic: 12.24 on 5 and 42 DF,  p-value: 2.388e-07</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.fs2.v) <span class="co">#summary on validation data</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = model2, data = prostate.v)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7509 -0.5067  0.1642  0.6007  1.6324 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.27905    0.22835   5.601 1.39e-06 ***
## cancer_vol                    0.07610    0.01970   3.863 0.000372 ***
## benign_prostatic_hyperplasia  0.10556    0.04407   2.395 0.021049 *  
## seminal_vesicle_invasion1     0.33023    0.48883   0.676 0.502942    
## gleason_score7                0.18969    0.28902   0.656 0.515109    
## gleason_score8                0.85107    0.48734   1.746 0.087888 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8741 on 43 degrees of freedom
## Multiple R-squared:  0.5915, Adjusted R-squared:  0.544 
## F-statistic: 12.45 on 5 and 43 DF,  p-value: 1.702e-07</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percent change in parameter estimation</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(model2)<span class="sc">-</span><span class="fu">coef</span>(fit.fs2.v))<span class="sc">/</span><span class="fu">abs</span>(<span class="fu">coef</span>(model2))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                  (Intercept)                   cancer_vol 
##                       17.547                      102.440 
## benign_prostatic_hyperplasia    seminal_vesicle_invasion1 
##                        8.853                       64.052 
##               gleason_score7               gleason_score8 
##                       26.773                       15.145</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>sd.fs2<span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)<span class="sc">$</span>coefficients[,<span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>sd.fs2.v<span class="ot">&lt;-</span> <span class="fu">summary</span>(fit.fs2.v)<span class="sc">$</span>coefficients[,<span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="co">#percent change in standard errors</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">abs</span>(sd.fs2<span class="sc">-</span>sd.fs2.v)<span class="sc">/</span>sd.fs2<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                  (Intercept)                   cancer_vol 
##                        1.990                        2.434 
## benign_prostatic_hyperplasia    seminal_vesicle_invasion1 
##                       33.791                       75.188 
##               gleason_score7               gleason_score8 
##                       22.020                       62.438</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="do">##mean squared prediction error</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>(pred.fs2<span class="ot">&lt;-</span><span class="fu">predict.lm</span>(model2, prostate.v[,<span class="sc">-</span><span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6       10       12 
## 1.572303 1.824268 1.832872 1.562579 1.630834 1.564409 1.598097 1.906309 
##       16       17       18       19       20       21       22       23 
## 1.726598 2.170094 1.922452 1.572728 2.365309 1.669973 2.526982 1.616730 
##       31       35       36       37       38       40       43       44 
## 2.289928 1.588471 2.798928 2.500197 1.869846 2.142205 2.154552 2.030986 
##       45       46       47       48       49       52       53       56 
## 2.535127 2.188258 4.420897 2.466368 1.767571 2.517440 2.303174 2.752040 
##       57       58       61       62       63       64       66       67 
## 1.909458 2.011987 2.607475 3.496705 2.896299 3.738885 2.335168 2.668700 
##       69       82       85       90       91       93       94       95 
## 1.575224 2.423408 3.000089 3.636160 2.520709 3.846006 4.923281 3.899057 
##       97 
## 4.567610</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>(mspe.fs2<span class="ot">&lt;-</span><span class="fu">mean</span>((pred.fs2<span class="sc">-</span>prostate.v[,<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1703.327</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>(press.fs2<span class="sc">/</span>n)</span></code></pre></div>
<pre><code>## [1] 0.479442</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>(mse.fs2)</span></code></pre></div>
<pre><code>## [1] 0.4370997</code></pre>
<ul>
<li>Model 1 is preferred based on smaller <span class="math inline">\(MSPE_v\)</span> and more consistent parameter estimation in training and validation data set</li>
</ul>
</div>
<div id="part-v-model-diagnostics-outlying-and-influential-cases" class="section level3">
<h3>Part V: Model diagnostics: Outlying and influential cases</h3>
<ul>
<li>Conduct model diagnostics for the “final model” (fitted on the entire data set).</li>
<li>Draw residual vs fitted value plot and residual Q-Q plot</li>
<li>Obtain the studentized deleted residuals and identify any outlying Y observations. Use the Bonferroni outlier test procedure at α = 0.1.</li>
<li>Obtain the leverage and identify any outlying X observations. Draw residual vs. leverage plot.</li>
<li>Draw an influence index plot using Cook’s distance. Are there any influential cases according to this measure?</li>
<li>Calculate the average absolute percent difference in the fitted values with and without the most influential case identified from the previous question. What does this measure indicate the influence of this case?</li>
</ul>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>final_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(psa_level<span class="sc">~</span>cancer_vol<span class="sc">+</span> benign_prostatic_hyperplasia <span class="sc">+</span> </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>    seminal_vesicle_invasion, <span class="at">data =</span> prostate)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psa_level ~ cancer_vol + benign_prostatic_hyperplasia + 
##     seminal_vesicle_invasion, data = prostate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9867 -0.4996  0.1032  0.5545  1.4993 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   1.51484    0.13206  11.471  &lt; 2e-16 ***
## cancer_vol                    0.07618    0.01256   6.067 2.78e-08 ***
## benign_prostatic_hyperplasia  0.09971    0.02674   3.729 0.000331 ***
## seminal_vesicle_invasion1     0.82194    0.23858   3.445 0.000858 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7861 on 93 degrees of freedom
## Multiple R-squared:  0.5502, Adjusted R-squared:  0.5357 
## F-statistic: 37.92 on 3 and 93 DF,  p-value: 4.247e-16</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(final_mod)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: psa_level
##                              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## cancer_vol                    1 55.164  55.164  89.271 3.006e-15 ***
## benign_prostatic_hyperplasia  1  7.803   7.803  12.628 0.0005992 ***
## seminal_vesicle_invasion      1  7.334   7.334  11.868 0.0008583 ***
## Residuals                    93 57.468   0.618                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_mod,<span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="do">## check outliers in Y</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">residuals</span>(final_mod)<span class="co"># residuals of the final model</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(final_mod<span class="sc">$</span>coefficients)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>n.s<span class="ot">&lt;-</span><span class="fu">nrow</span>(prostate)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">influence</span>(final_mod)<span class="sc">$</span>hat</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>d.res.std<span class="ot">&lt;-</span><span class="fu">studres</span>(final_mod) <span class="co">#studentized deleted residuals</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n.s),n.s<span class="sc">-</span>p) <span class="co"># bonferronis thresh hold</span></span></code></pre></div>
<pre><code>## [1] 3.38885</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>idx.Y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">which</span>(<span class="fu">abs</span>(d.res.std)<span class="sc">&gt;=</span><span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n.s),n.s<span class="sc">-</span>p)))</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>idx.Y <span class="do">## outliers</span></span></code></pre></div>
<pre><code>## integer(0)</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>idx.X <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">which</span>(h1<span class="sc">&gt;</span>(<span class="dv">2</span><span class="sc">*</span>p<span class="sc">/</span>n.s)))</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>idx.X <span class="do">## outliers</span></span></code></pre></div>
<pre><code>## [1] 55 64 68 73 78 86 91 94 97</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1,res,<span class="at">xlab=</span><span class="st">&quot;leverage&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;residuals&quot;</span>, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_mod, <span class="at">which=</span><span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;aquamarine2&quot;</span>) <span class="co">#Case 94 is an influential case according to Cook’s distance.</span></span></code></pre></div>
<p><img src="STA206-Kay-Royo-Final-Project_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>final_mod2<span class="ot">&lt;-</span><span class="fu">lm</span>(final_mod, <span class="at">data=</span>prostate[<span class="sc">-</span><span class="dv">94</span>,])</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">fitted</span>(final_mod)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">fitted</span>(final_mod2)</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>SUM<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">abs</span>((f1[<span class="sc">-</span><span class="dv">94</span>]<span class="sc">-</span>f2)<span class="sc">/</span>f1[<span class="sc">-</span><span class="dv">94</span>]))</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>SUM<span class="ot">&lt;-</span>SUM<span class="sc">+</span><span class="fu">abs</span>((f1[<span class="dv">94</span>]<span class="sc">-</span><span class="fu">predict</span>(final_mod,<span class="at">newdata =</span> prostate[<span class="dv">94</span>,]))<span class="sc">/</span>f1[<span class="dv">94</span>])</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>per.average<span class="ot">&lt;-</span>SUM<span class="sc">/</span>n.s</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>per.average</span></code></pre></div>
<pre><code>##         94 
## 0.01872144</code></pre>
<ul>
<li>The potential influential case identified previously is the 94th case, we fit the model without 94th case and calculate the average absolute difference in the fitted values as 1.87%. For 94th case, the percentage change on the fitted value with or without the case is very small. Therefore, no case have a large influence on prediction. Hence, all cases can be retained.</li>
</ul>
</div>
</div>
<div id="conclusion-and-discussion" class="section level2">
<h2>Conclusion and Discussion</h2>
<p>By using multiple regression analyses, it can be concluded that three predictors (cancer volume, seminal vesicle invasion, and benign prostatic hyperplasia) are important clinical measurements that can be used in the determination of prostate-specific antigen (PSA) level among men who are diagnosed with prostate cancer. However, the performance of the model that is identified in this analysis to predict PSA level using these predictors can be improved. Other important clinical measurements not included in the original dataset can be added to the analysis. Although seminal vesicle invasion was not present in most of the 97 men with advanced prostate cancer, it is still important in identifying PSA level. This supports the fact the PSA level does not always imply the presence of prostate cancer in men which is a limitation of PSA screening for cancer. The result of this analysis would generally not apply to every man with prostate cancer in rare cases and to those who are not diagnosed with prostate cancer. Since the dataset used for this analysis include a small group of men ages 41 to 79 diagnosed with prostate cancer, a larger collection of data which includes both men with and without prostate cancer from a wider age range might be more helpful in determining the relationship between PSA level and other clinical measurements. For further analysis of this data, other statistical analysis can also be used which may result in more accurate results.</p>
<div id="references" class="section level3">
<h3>References</h3>
<ul>
<li><p>American Cancer Society. Key Statistics for Prostate Cancer 2021. American Cancer Society. Atlanta, Ga. 2021. <a href="https://www.cancer.org/cancer/prostate-cancer/about/key-statistics.html" class="uri">https://www.cancer.org/cancer/prostate-cancer/about/key-statistics.html</a></p></li>
<li><p>Stamey, T., Kabalin, J., McNeal, J., Johnstone, I., Freiha, F., Redwine, E. and Yang, N. (1989). Prostate specific antigen in the diagnosis and treatment of adenocarcinoma of the prostate II radical prostatectomy treated patients, Journal of Urology 16: 1076 – 1083.</p></li>
<li><p>Whelan, Corey. 8 Non-Cancerous Causes of High PSA Levels. 2017. Healthline <a href="https://www.healthline.com/health/mens-health/high-psa-no-cancer" class="uri">https://www.healthline.com/health/mens-health/high-psa-no-cancer</a></p></li>
</ul>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
